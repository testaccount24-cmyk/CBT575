./ ADD NAME=CONHEX
         MACRO                                                             00001
&N      CONHEX                                                             00002
*** CONHEX     EDYCJA AAN-003                                              00003
         AIF   ('&N' NE '').E1                                             00004
         MNOTE 12,'   ********   NIEOKRESLONA NAZWA SEKCJI'                00005
         MEXIT                                                             00006
.E1      ANOP                                                              00007
         SEKCJA &N,B=12,V=VFCHX001                                         00008
         LR    3,0                                                         00009
         LR    7,1                                                         00010
         LR    8,2                                                         00011
         LA    9,X'F'                                                      00012
         BAL   10,*+20                                                     00013
         DC    C'0123456789ABCDEF'                                         00014
         BALR  11,0                                                        00015
         SR    5,5                                                         00016
         IC    5,0(3)                                                      00017
         LR    6,5                                                         00018
         NR    6,9                                                         00019
         SRA   5,4                                                         00020
         IC    5,0(5,10)                                                   00021
         STC   5,0(1)                                                      00022
         IC    5,0(6,10)                                                   00023
         STC   5,1(1)                                                      00024
         LA    3,1(3)                                                      00025
         LA    1,2(1)                                                      00026
         BCTR  2,11                                                        00027
         LR    1,7                                                         00028
         LR    2,8                                                         00029
         SLA   8,17                                                        00030
         AR    2,8                                                         00031
         LM    3,12,32(13)                                                 00032
         SR    15,15                                                       00033
         BR    14                                                          00034
         MEND                                                              00035
./ ADD NAME=DCBDEF   0100-84290-84290-0840-00163-00163-00000-ZTSDKJB
* DEFINICJE OFFSETOW DLA DCB                                            AGW00001
         MACRO                                                          AGW00002
         DCBDEF                                                         AGW00003
DCBDEN   EQU   18                                                       AGW00004
DCBBUFNO EQU   20                                                       AGW00005
DCBBUFCB EQU   21                                                       AGW00006
DCBBUFL  EQU   24                                                       AGW00007
DCBDSORG EQU   26                                                       AGW00008
DCBEODAD EQU   32                                                       AGW00009
DCBRECFM EQU   36                                                       AGW00010
DCBDNAM  EQU   40                                                       AGW00011
DCBOFLGS EQU   48                                                       AQO00012
DCBSYNAD EQU   57                                                       APC00013
DCBBLKSI EQU   62                                                       AGW00014
DCBEOBAD EQU   72                                                       AGW00015
DCBRECAD EQU   76                                                       APC00016
DCBLRECL EQU   82                                                       AGW00017
DCBPRECL EQU   90                                                       AGW00018
         MEND                                                           AGW00019
         MACRO                                                          AGZ00020
         DCBDEF &ACS,&DEV,&MCR                                          AGZ00021
* MAKROROZKAZ GENERUJACY OFFSETY DO DCB                                 AGZ00022
* ACS=                                                                  AGZ00023
*     EXCP                                                              AGZ00024
*    *QSAM                                                              AGZ00025
*     BPAM                                                              AGZ00026
*     BSAM                                                              AGZ00027
* DEV=                                                                  AGZ00028
*    *DA                                                                AGZ00029
*     MT                                                                AGZ00030
*     PR                                                                AGZ00031
*     PT                                                                AGZ00032
*     CR                                                                AGZ00033
*     ALL                                                               AGZ00034
* MCR                                                                   AGZ00035
*    *RD                                                                AGZ00036
*     WT                                                                AGZ00037
         AIF   ('&ACS' NE '').E01                                       AGZ00038
&ACS     SETC  'QSAM'                                                   AGZ00039
.E01     ANOP                                                           AGZ00040
         AIF   ('&DEV' NE '').E02                                       AGZ00041
&DEV     SETC  'DA'                                                     AGZ00042
.E02     ANOP                                                           AGZ00043
         AIF   ('&MCR' NE '').E03                                       AGZ00044
&MCR     SETC  'RD'                                                     AGZ00045
.E03     ANOP                                                           AGZ00046
         AIF   ('&ACS' NE 'ISAM' OR '&ACS' NE 'QISAM').E04              AGZ00047
&DEV     SETC  'DA'                                                     AGZ00048
         AIF   ('&DEV' NE 'DA').D01                                     AGZ00049
DCBDEVT  EQU   17                                                       AGY00050
DCBRELAD EQU    0                                                       AGY00051
DCBKEYCN EQU    4                                                       AGY00052
DCBFDAD  EQU    5                                                       AGY00053
DCBDVTBL EQU   13                                                       AGY00054
DCBKEYLE EQU   16                                                       AGY00055
DCBTRBAL EQU   18                                                       AGY00056
.D01     ANOP                                                           AGZ00057
         AIF   ('&DEV' NE 'MT').D02                                     AGZ00058
DCBBLKCT EQU   12                                                       AGY00059
DCBTRTCH EQU   16                                                       AGY00060
DCBDEN   EQU   18                                                       AGY00061
.D02     ANOP                                                           AGZ00062
         AIF   ('&DEV' NE 'PT').D03                                     AGZ00063
DCBLCTBL EQU    8                                                       AGY00064
DCBCODE  EQU   16                                                       AGY00065
.D03     ANOP                                                           AGZ00066
         AIF   ('&DEV' NE 'CR').D04                                     AGZ00067
DCBMODE  EQU   16                                                       AGY00068
DCBSTACK EQU   16                                                       AGY00069
DCBFUNC  EQU   19                                                       AGY00070
.D04     ANOP                                                           AGZ00071
         AIF   ('&DEV' NE 'PR').D05                                     AGZ00072
DCBPRTSP EQU   16                                                       AGY00073
.D05     ANOP                                                           AGZ00074
DCBBUFNO EQU   20                                                       AGY00075
DCBBUFCB EQU   21                                                       AGY00076
DCBBUFL  EQU   24                                                       AGY00077
DCBDSORG EQU   26                                                       AGY00078
DCBIOBAD EQU   28                                                       AGY00079
DCBLNP   EQU   28                                                       AGY00080
DCBQSLM  EQU   28                                                       AGY00081
DCBODEBA EQU   29                                                       AGY00082
DCBHIARC EQU   32                                                       AGY00083
DCBBFTEK EQU   32                                                       AGY00084
DCBBFALN EQU   32                                                       AGY00085
DCBEODAD EQU   33                                                       AGY00086
DCBRECFM EQU   36                                                       AGY00087
DCBEXLST EQU   37                                                       AGY00088
DCBDDNAM EQU   40                                                       AGY00089
DCBOFLGS EQU   48                                                       AGY00090
DCBIFLG  EQU   49                                                       AGY00091
DCBMACR  EQU   50                                                       AGY00092
DCBTIOT  EQU   40                                                       AGY00093
DCBMACRF EQU   42                                                       AGY00094
DCBIFLGS EQU   44                                                       AGY00095
DCBDEBAD EQU   44                                                       AGY00096
DCBOFLGS EQU   48                                                       AGY00097
DCBOPTCD EQU   52                                                       AGY00098
         AIF   ('&ACS' NE 'EXCP').A01                                   AGZ00099
DCBEOFEA EQU   60                                                       AGY00100
DCBPCIA  EQU   62                                                       AGY00101
DCBSIOA  EQU   64                                                       AGY00102
DCBCENDA EQU   66                                                       AGY00103
DCBXENDA EQU   68                                                       AGY00104
         MEXIT                                                          AGZ00105
.A01     ANOP                                                           AGZ00106
         AIF   ('&ACS' NE 'BSAM' OR '&ACS' NE 'BPAM').A02               AGZ00107
DCBREAD  EQU   49                                                       AGY00108
DCBWRITE EQU   49                                                       AGY00109
DCBOPTCD EQU   52                                                       AGY00110
DCBCHECK EQU   53                                                       AGY00111
DCBIOBL  EQU   56                                                       AGZ00112
DCBSYNAD EQU   57                                                       AGY00113
DCBCIND1 EQU   60                                                       AGY00114
DCBCIND2 EQU   61                                                       AGY00115
DCBBLKSI EQU   62                                                       AGY00116
DCBWCPO  EQU   64                                                       AGY00117
DCBWCPL  EQU   65                                                       AGY00118
DCBOFFSR EQU   66                                                       AGY00119
DCBOFFSW EQU   67                                                       AGY00120
DCBIOBA  EQU   68                                                       AGY00121
DCBNCP   EQU   72                                                       AGY00122
DCBEOBW  EQU   73                                                       AGZ00123
DCBEOBW  EQU   76                                                       AGY00124
DCBDIRCT EQU   80                                                       AGY00125
DCBUSASI EQU   80                                                       AGY00126
DCBBUFOF EQU   81                                                       AGY00127
DCBLRECL EQU   82                                                       AGY00128
DCBCNTRL EQU   84                                                       AGY00129
DCBNOTE  EQU   84                                                       AGZ00130
DCBPOINT EQU   84                                                       AGY00131
         MEXIT                                                          AGZ00132
.A02     ANOP                                                           AGZ00133
         AIF   ('&ACS' NE 'QSAM').A03                                   AGZ00134
DCBGET   EQU   49                                                       AGY00135
DCBPUT   EQU   49                                                       AGY00136
DCBOPTCD EQU   52                                                       AGY00137
DCBGERR  EQU   53                                                       AGY00138
DCBPERR  EQU   53                                                       AGY00139
DCBIOBL  EQU   56                                                       AGY00140
DCBSYNAD EQU   57                                                       AGY00141
DCBCIND1 EQU   60                                                       AGY00142
DCBCIND2 EQU   61                                                       AGY00143
DCBBLKSI EQU   62                                                       AGY00144
DCBWCPO  EQU   64                                                       AGY00145
DCBWCPL  EQU   65                                                       AGY00146
DCBOFFSR EQU   66                                                       AGY00147
DCBOFFSW EQU   67                                                       AGY00148
DCBIOBA  EQU   68                                                       AGY00149
DCBEOBAD EQU   72                                                       AGY00150
DCBLCCW  EQU   72                                                       AGY00151
DCBRECAD EQU   76                                                       AGY00152
DCBCCW   EQU   76                                                       AGY00153
DCBQSWS  EQU   80                                                       AGY00154
DCBBUFOF EQU   81                                                       AGY00155
DCBDIRCQ EQU   81                                                       AGY00156
DCBLRECL EQU   82                                                       AGY00157
DCBEROPT EQU   84                                                       AGY00158
DCBCNTRL EQU   85                                                       AGY00159
DCBPRECL EQU   90                                                       AGY00160
DCBEOB   EQU   92                                                       AGY00161
.A03     ANOP                                                           AGZ00162
         MEND                                                           AGZ00163
./ ADD NAME=DCBEX    0101-99196-99196-0851-00324-00324-00000-VHUTCH
         MACRO                                                          ABJ00001
&NN      DCBEX &WS,&R=,&L=,&B=0,&N=,&K=                                 ABO00002
         LCLC  &C,&D                                                    ABJ00003
*** DCBEX      WERSJA-004                                               ABV00004
&C       SETC  'IHB'.'&SYSNDX'                                          ABJ00005
&D       SETC  '*'                                                      ABJ00005
         AIF   ('&NN' EQ '').D1                                         ABO00006
&NN      DS    0H                 USTAWIENIE ETYKIETY                   ABO00007
&D       SETC  '&NN'                                                    ABJ00005
.D1      USING &D,15                                                    ABO00008
         AIF   ('&WS' EQ 'DCBPREF').K1                                  ABO00009
         AIF   ('&R' EQ '' AND '&L' EQ '' AND '&B' EQ '' AND '&N' EQ ''XABO00010
               ).G3                                                     ABO00011
         AIF   ('&WS' EQ '').D5                                         ABO00012
         AIF   ('&WS'(1,1) NE '(').D2                                   ABO00013
         LR    3,&WS              ADRES WSK.ODP.W REJ                   ABO00014
         AGO   .D4                                                      ABO00015
.D2      AIF   ('&WS'(1,2) NE 'A(' AND '&WS'(1,2) NE 'V(').D3           ABO00016
         L     3,&C.X             ADRES WSK.ODP.W STA                   ABO00017
         AGO   .D4                                                      ABO00018
.D3      LA    3,&WS              ADRES WSK.ODP.JAWNY                   ABO00019
.D4      MVI   0(3),0             ZEROWANIE WSK.ODP.                    ABO00020
.D5      AIF   ('&R' EQ '').F3                                          ABO00021
.* OBSLUGA RECFM                                                        ABO00022
         TM    36(1),X'FE'        CZY RECFM OKRESLONY                   ABO00023
         BNZ   &C.A               TAK                                   ABO00024
         AIF   ('&R' NE 'F').E1                                         ABO00025
         OI    36(1),X'80'        RECFM=F                               ABO00026
         AGO   .F1                                                      ABO00027
.E1      AIF   ('&R' NE 'V').E2                                         ABO00028
         OI    36(1),X'40'        RECFM=V                               ABO00029
         AGO   .F1                                                      ABO00030
.E2      AIF   ('&R' NE 'FA').E3                                        ABO00031
         OI    36(1),X'84'        RECFM=FA                              ABO00032
         AGO   .F1                                                      ABO00033
.E3      AIF   ('&R' NE 'VA').E4                                        ABO00034
         OI    36(1),X'44'        RECFM=VA                              ABO00035
         AGO   .F1                                                      ABO00036
.E4      AIF   ('&R' NE 'FM').E5                                        ABO00037
         OI    36(1),X'82'        RECFM=FM                              ABO00038
         AGO   .F1                                                      ABO00039
.E5      AIF   ('&R' NE 'FB').E6                                        ABO00040
         OI    36(1),X'90'        RECFM=FB                              ABO00041
         AGO   .F1                                                      ABO00042
.E6      AIF   ('&R' NE 'VB').E7                                        ABO00043
         OI    36(1),X'50'        RECFM=VB                              ABO00044
         AGO   .F1                                                      ABO00045
.E7      AIF   ('&R' NE 'FBA').E8                                       ABO00046
         OI    36(1),X'94'        RECFM=FBA                             ABO00047
         AGO   .F1                                                      ABO00048
.E8      AIF   ('&R' NE 'VBA').E9                                       ABO00049
         OI    36(1),X'54'        RECFM=VBA                             ABO00050
         AGO   .F1                                                      ABO00051
.E9      AIF   ('&R' NE 'FBM').E10                                      ABO00052
         OI    36(1),X'92'        RECFM=FBM                             ABO00053
         AGO   .F1                                                      ABO00054
.E10     AIF   ('&R' NE 'VBS').E11                                      ABO00055
         OI    36(1),X'58'        RECFM=VBS                             ABO00056
         AGO   .F1                                                      ABO00057
.E11     OI    36(1),&R           USTAW RECFM                           ABO00058
.F1      AIF   ('&WS' EQ '').F2                                         ABO00059
         OI    0(3),X'80'         WSK.ODP.NA RECFM                      ABO00060
.F2      ANOP                                                           ABO00061
&C.A     EQU   *                  KONIEC RECFM                          ABO00062
.F3      AIF   ('&L' EQ '' AND '&B' EQ '').G1                           ABO00063
         LH    5,62(1)            WEZ BLKSIZE                           ABO00064
         LH    6,82(1)            WEZ LRECL                             ABO00065
         AIF   ('&L' EQ '').F5                                          ABO00066
.* OBSLUGA LRECL                                                        ABO00067
         LTR   6,6                CZY LRECL OKRESLONY                   ABO00068
         BNZ   &C.C               TAK                                   ABO00069
         TM    36(1),X'80'        CZY RECFM=F                           ABO00070
         BZ    &C.B               NIE                                   ABO00071
         TM    36(1),X'10'        CZY RECFM=FB                          ABO00072
         BO    &C.B               TAK                                   ABO00073
         LTR   5,5                CZY JEST BLKSIZE                      ABO00074
         BNZ   &C.C               TAK                                   ABO00075
&C.B     LH    6,&C.Y             WEZ STAND.LRECL                       ABO00076
         STH   6,82(1)            USTAW LRECL                           ABO00077
         AIF   ('&WS' EQ '').F4                                         ABO00078
         OI    0(3),X'40'         WSK.ODP.NA LRECL                      ABO00079
.F4      ANOP                                                           ABO00080
&C.C     EQU   *                  KONIEC LRECL                          ABO00081
.F5      AIF   ('&B' EQ '').G1                                          ABO00082
.* OBSLUGA BLKSIZE                                                      ABO00083
         AIF   ('&R' EQ '' AND N'&B GT 1).H1                            ABO00084
         AIF   ('&R' EQ '' AND '&L' EQ '').F6                           ABO00085
         TM    36(1),X'80'        CZY RECFM=F                           ABO00086
         BZ    &C.D               NIE                                   ABO00087
         TM    36(1),X'10'        CZY RECFM=FB                          ABO00088
         BO    &C.D               TAK                                   ABO00089
         LTR   6,6                CZY BRAK LRECL                        ABO00090
         BZ    &C.H               TAK                                   ABO00091
&C.D     EQU   *                  KONIEC F I NIE B                      ABO00092
.F6      TM    36(1),X'40'        CZY RECFM=F                           ABO00093
         BZ    *+8                TAK                                   ABO00094
         LA    6,4(6)             NIE, LRECL:=LRECL+4                   ABO00095
         LTR   5,5                CZY BLKSIZE OKRESL.                   ABO00096
         AIF   ('&B(1)' NE '0').F7                                      ABO00097
         BZ    &C.G               NIE , BLKSIZE=&MIN                    ABO00098
         AGO   .F8                                                      ABO00099
.F7      BNZ   &C.E               TAK                                   ABO00100
         LH    5,&C.Z             WEZ STAND.BLKSIZE                     ABO00101
         STH   5,62(1)            USTAW BLKSIZE                         ABO00102
         AIF   ('&WS' EQ '').F8                                         ABO00103
         OI    0(3),X'20'         WSK.ODP.NA BLKSIZE                    ABO00104
.F8      ANOP                                                           ABO00105
&C.E     TM    36(1),X'40'        CZY RECFM=F                           ABO00106
         BZ    &C.F               TAK                                   ABO00107
         CR    5,6                NIE,SPRAWDZ BLKSIZE                   ABO00108
         BNL   &C.H               DOBRY                                 ABO00109
         B     &C.G               ZLY                                   ABO00110
&C.F     XR    4,4                SPRAWDZ BLKSIZE                       ABO00111
         DR    4,6                DLA RECFM = F                         ABO00112
         LTR   4,4                CZY BLKSIZE / LRECL                   ABO00113
         BZ    &C.H               TAK                                   ABO00114
.F9      ANOP                                                           ABO00115
&C.G     STH   6,62(1)            USTAW BLKSIZE=BMIN                    ABO00116
         AIF   ('&WS' EQ '').F10                                        ABO00117
         OI    0(3),X'10'         WSK.ODP.NA BMIN                       ABO00118
.F10     ANOP                                                           ABO00119
&C.H     EQU   *                  KONIEC BLKSIZE                        ABO00120
.G1      AIF   ('&N' EQ '').G3                                          ABO00121
.* OBSLUGA GETPOOL                                                      ABO00122
         LR    6,1                SCHOWAJ ADRES DCB                     ABO00123
         XR    4,4                                                      ABO00124
         IC    4,20(1)            WEZ BUFNO                             ABO00125
         LTR   4,4                CZY = 0                               ABO00126
         BNZ   &C.I               NIE                                   ABO00127
         LA    4,&N               WEZ STAND.BUFNO                       ABO00128
         AIF   ('&WS' EQ '').G2                                         ABO00129
         OI    0(3),X'08'         WSK.ODP.NA BUFNO                      ABO00130
.G2      ANOP                                                           ABO00131
&C.I     LH    5,62(1)            WEZ BLKSIZE                           ABO00132
         GETPOOL (1),(4),(5)                                            ABO00133
         LR    1,6                ADRES DCB                             ABO00134
.G3      AIF   ('&K' EQ '').G7                                          ABO00135
.* OBSLUGA KONKATENACJI                                                 ABO00136
         AIF   ('&K'(1,1) NE '(').G4                                    ABO00137
         LR    3,&K               ADRES WSK.KONK.W RE                   ABO00138
         AGO   .G6                                                      ABO00139
.G4      AIF   ('&K'(1,2) NE 'A(' AND '&K'(1,2) NE 'V(').G5             ABO00140
         L     3,&C.W             ADRES WSK.KONK.W ST                   ABO00141
         AGO   .G6                                                      ABO00142
.G5      LA    3,&K               ADRES WSK.KONK.JAWN                   ABO00143
.G6      TM    0(3),X'0F'         CZY PIERWSZY RAZ                      ABO00144
         BZ    *+10               TAK                                   ABO00145
         OI    0(3),X'10'         NIE, USTAW POM.DOK.                   ABO00146
         BR    14                 WROC                                  ABO00147
         OI    0(3),X'01'         USTAW, ZE NIE PIER.                   ABO00148
         OI    48(1),X'08'        USTAW KONKATENACJE                    ABO00149
.G7      BR    14                 WROC                                  ABO00150
         AIF   ('&K' EQ '').G8                                          ABO00151
         AIF   ('&K'(1,2) NE 'A(' AND '&K'(1,2) NE 'V(').G8             ABO00152
&C.W     DC    &K                 ADRES WSK.KONKATEN.                   ABO00153
.G8      AIF   ('&WS' EQ '').G9                                         ABO00154
         AIF   ('&WS'(1,2) NE 'A(' AND '&WS'(1,2) NE 'V(').G9           ABO00155
&C.X     DC    &WS                ADRES WSK.ODPOWIED.                   ABO00156
.G9      AIF   ('&L' EQ '').G10                                         ABO00157
&C.Y     DC    AL2(&L)            WART.STAND.LRECL                      ABO00158
.G10     AIF   ('&B' EQ '').G11                                         ABO00159
         AIF   ('&B(1)' EQ '0').G11                                     ABO00160
&C.Z     DC    AL2(&B(1))                                               ABO00161
.G11     DROP  15                                                       ABO00162
         MEXIT                                                          ABO00163
.* OBSLUGA BLKSIZE DLA F                                                ABO00164
.H1      AIF   ('&B(2)' NE 'F').H5                                      ABO00165
         AIF   ('&R' EQ '' AND '&L' EQ '').H2                           ABO00166
         TM    36(1),X'10'        CZY RECFM=FB                          ABO00167
         BO    &C.D               TAK                                   ABO00168
         LTR   6,6                CZY BRAK LRECL                        ABO00169
         BZ    &C.H               TAK                                   ABO00170
&C.D     EQU   *                  KONIEC F I NIE B                      ABO00171
.H2      LTR   5,5                CZY BLKSIZE OKRESL.                   ABO00172
         AIF   ('&B(1)' NE '0').H3                                      ABO00173
         BZ    &C.G               NIE , BLKSIZE=BMIN                    ABO00174
         AGO   .H4                                                      ABO00175
.H3      BNZ   &C.E               TAK                                   ABO00176
         LH    5,&C.Z             WEZ STAND.BLKSIZE                     ABO00177
         STH   5,62(1)            USTAW BLKSIZE                         ABO00178
         AIF   ('&WS' EQ '').H4                                         ABO00179
         OI    0(3),X'20'         WSK.ODP.NA BLKSIZE                    ABO00180
.H4      ANOP                                                           ABO00181
&C.E     XR    4,4                SPRAWDZ BLKSIZE                       ABO00182
         DR    4,6                CZY PODZIELONY                        ABO00183
         LTR   4,4                PRZEZ LRECL                           ABO00184
         BZ    &C.H               TAK                                   ABO00185
         AGO   .F9                                                      ABO00186
.* OBSLUGA BLKSIZE DLA V                                                ABO00187
.H5      LA    6,4(6)             LRECL:=LRECL+4                        ABO00188
         LTR   5,5                CZY BLKSIZE OKRESL.                   ABO00189
         AIF   ('&B(1)' NE '0').H6                                      ABO00190
         BZ    &C.G               NIE , BLKSIZE=BMIN                    ABO00191
         AGO   .H7                                                      ABO00192
.H6      BNZ   &C.E               TAK                                   ABO00193
         LH    5,&C.Z             WEZ STAND.BLKSIZE                     ABO00194
         STH   5,62(1)            USTAW BLKSIZE                         ABO00195
         AIF   ('&WS' EQ '').H7                                         ABO00196
         OI    0(3),X'20'         WSK.ODP.NA BLKSIZE                    ABO00197
.H7      ANOP                                                           ABO00198
&C.E     CR    5,6                SPRAWDZ BLKSIZE                       ABO00199
         BNL   &C.H               DOBRY                                 ABO00200
         AGO   .F9                                                      ABO00201
.* PARAMETRY Z TABLICY "DCBPREF"                                        ABO00202
.K1      LA    3,0(1)             ADRES DCB                             ABV00203
         LA    2,8                PREFIX                                ABO00204
         SR    3,2                ADRES DCBPREF                         ABO00205
         AIF   ('&R' EQ '' AND '&L' EQ '' AND '&B' EQ '' AND '&N' EQ ''XABO00206
               ).K7                                                     ABO00207
         MVI   1(3),0             ZEROWANIE WSK.ODP.                    ABO00208
         AIF   ('&R' EQ '').K2                                          ABO00209
.* OBSLUGA RECFM                                                        ABO00210
         TM    36(1),X'FE'        CZY RECFM OKRESLONY                   ABO00211
         BNZ   &C.A               TAK                                   ABO00212
         OC    36(1,1),3(3)       NIE                                   ABO00213
         OI    1(3),X'80'         WSK.ODP.NA RECFM                      ABO00214
&C.A     EQU   *                  KONIEC RECFM                          ABO00215
.K2      AIF   ('&L' EQ '' AND '&B' EQ '').K6                           ABO00216
         LH    5,62(1)            WEZ BLKSIZE                           ABO00217
         LH    6,82(1)            WEZ LRECL                             ABO00218
         AIF   ('&L' EQ '').K3                                          ABO00219
.* OBSLUGA LRECL                                                        ABO00220
         LTR   6,6                CZY LRECL OKRESLONY                   ABO00221
         BNZ   &C.C               TAK                                   ABO00222
         TM    36(1),X'80'        CZY RECFM=F                           ABO00223
         BZ    &C.B               NIE                                   ABO00224
         TM    36(1),X'10'        CZY RECFM=FB                          ABO00225
         BO    &C.B               TAK                                   ABO00226
         LTR   5,5                CZY JEST BLKSIZE                      ABO00227
         BNZ   &C.C               TAK                                   ABO00228
&C.B     LH    6,4(3)             WEZ STAND.LRECL                       ABO00229
         STH   6,82(1)            USTAW LRECL                           ABO00230
         OI    1(3),X'40'         WSK.ODP.NA LRECL                      ABO00231
&C.C     EQU   *                  KONIEC LRECL                          ABO00232
.K3      AIF   ('&B' EQ '').K6                                          ABO00233
.* OBSLUGA BLKSIZE                                                      ABO00234
         AIF   ('&R' EQ '' AND N'&B GT 1).L1                            ABO00235
         AIF   ('&R' EQ '' AND '&L' EQ '').K4                           ABO00236
         TM    36(1),X'80'        CZY RECFM=F                           ABO00237
         BZ    &C.D               NIE                                   ABO00238
         TM    36(1),X'10'        CZY RECFM=FB                          ABO00239
         BO    &C.D               TAK                                   ABO00240
         LTR   6,6                CZY BRAK LRECL                        ABO00241
         BZ    &C.H               TAK                                   ABO00242
&C.D     EQU   *                  KONIEC F I NIE B                      ABO00243
.K4      TM    36(1),X'40'        CZY RECFM=F                           ABO00244
         BZ    *+8                TAK                                   ABO00245
         LA    6,4(6)             NIE, LRECL:=LRECL+4                   ABO00246
         LTR   5,5                CZY BLKSIZE OKRESL.                   ABO00247
         BNZ   &C.E               TAK                                   ABO00248
         LH    5,6(3)             WEZ STAND.BLKSIZE                     ABO00249
         LTR   5,5                CZY = 0                               ABO00250
         BZ    &C.G               TAK                                   ABO00251
         STH   5,62(1)            NIE , USTAW BLKSIZE                   ABO00252
         OI    1(3),X'20'         WSK.ODP.NA BLKSIZE                    ABO00253
&C.E     TM    36(1),X'40'        CZY RECFM=F                           ABO00254
         BZ    &C.F               TAK                                   ABO00255
         CR    5,6                NIE,SPRAWDZ BLKSIZE                   ABO00256
         BNL   &C.H               DOBRY                                 ABO00257
         B     &C.G               ZLY                                   ABO00258
&C.F     XR    4,4                SPRAWDZ BLKSIZE                       ABO00259
         DR    4,6                DLA RECFM = F                         ABO00260
         LTR   4,4                CZY BLKSIZE / LRECL                   ABO00261
         BZ    &C.H               TAK                                   ABO00262
.K5      ANOP                                                           ABO00263
&C.G     STH   6,62(1)            USTAW BLKSIZE=BMIN                    ABO00264
         OI    1(3),X'10'         WSK.ODP.NA BMIN                       ABO00265
&C.H     EQU   *                  KONIEC BLKSIZE                        ABO00266
.K6      AIF   ('&N' EQ '').K7                                          ABO00267
.* OBSLUGA GETPOOL                                                      ABO00268
         LR    6,1                SCHOWAJ ADRES DCB                     ABO00269
         XR    4,4                                                      ABO00270
         IC    4,20(1)            WEZ BUFNO                             ABO00271
         LTR   4,4                CZY = 0                               ABO00272
         BNZ   &C.I               NIE                                   ABO00273
         IC    4,2(3)             WEZ STAND.BUFNO                       ABO00274
         OI    1(3),X'08'         WSK.ODP.NA BUFNO                      ABO00275
&C.I     LH    5,62(1)            WEZ BLKSIZE                           ABO00276
         GETPOOL (1),(4),(5)                                            ABO00277
         LR    1,6                ADRES DCB                             ABO00278
.K7      AIF   ('&K' EQ '').K8                                          ABO00279
.* OBSLUGA KONKATENACJI                                                 ABO00280
         TM    0(3),X'0F'         CZY PIERWSZY RAZ                      ABO00281
         BZ    *+10               TAK                                   ABO00282
         OI    0(3),X'10'         NIE, USTAW POM.DOK.                   ABO00283
         BR    14                 WROC                                  ABO00284
         OI    0(3),X'01'         USTAW, ZE NIE PIER.                   ABO00285
         OI    48(1),X'08'        USTAW KONKATENACJE                    ABO00286
.K8      BR    14                 WROC                                  ABO00287
         DROP  15                                                       ABO00288
         MEXIT                                                          ABO00289
.* OBSLUGA BLKSIZE DLA F                                                ABO00290
.L1      AIF   ('&B(2)' NE 'F').L3                                      ABO00291
         AIF   ('&R' EQ '' AND '&L' EQ '').L2                           ABO00292
         TM    36(1),X'10'        CZY RECFM=FB                          ABO00293
         BO    &C.D               TAK                                   ABO00294
         LTR   6,6                CZY BRAK LRECL                        ABO00295
         BZ    &C.H               TAK                                   ABO00296
&C.D     EQU   *                  KONIEC F I NIE B                      ABO00297
.L2      LTR   5,5                CZY BLKSIZE OKRESL.                   ABO00298
         BNZ   &C.E               TAK                                   ABO00299
         LH    5,6(3)             WEZ STAND.BLKSIZE                     ABO00300
         LTR   5,5                CZY = 0                               ABO00301
         BZ    &C.G               TAK                                   ABO00302
         STH   5,62(1)            NIE , USTAW BLKSIZE                   ABO00303
         OI    1(3),X'20'         WSK.ODP.NA BLKSIZE                    ABO00304
&C.E     XR    4,4                SPRAWDZ BLKSIZE                       ABO00305
         DR    4,6                CZY PODZIELNY                         ABO00306
         LTR   4,4                PRZEZ LRECL                           ABO00307
         BZ    &C.H               TAK                                   ABO00308
         AGO   .K5                                                      ABO00309
.* OBSLUGA BLKSIZE DLA V                                                ABO00310
.L3      LA    6,4(6)             LRECL:=LRECL+4                        ABO00311
         LTR   5,5                CZY BLKSIZE OKRESL.                   ABO00312
         BNZ   &C.E               TAK                                   ABO00313
         LH    5,6(3)             WEZ STAND.BLKSIZE                     ABO00314
         LTR   5,5                CZY = 0                               ABO00315
         BZ    &C.G               TAK                                   ABO00316
         STH   5,62(1)            NIE , USTAW BLKSIZE                   ABO00317
         OI    1(3),X'20'         WSK.ODP.NA BLKSIZE                    ABO00318
&C.E     CR    5,6                SPRAWDZ BLKSIZE                       ABO00319
         BNL   &C.H               DOBRY                                 ABO00320
         AGO   .K5                                                      ABO00321
         MEND                                                           ABJ00322
./ ADD NAME=DCBPREF
         MACRO                                                          ABN00010
&N      DCBPREF &RECFM=0,&LRECL=0,&BLKSIZE=0,&BUFNO=2                   ABO00020
         LCLC  &C                                                       ABN00030
*** DCBPREF    WERSJA-002                                               ABO00040
&C       SETC  'IHB'.'&SYSNDX'                                          ABO00050
&N       DS    0F                 TABLICA DLA "DCBEX"                   ABN00060
         DC    AL1(0)             WSKAZNIK KONKATENAC                   ABN00070
         DC    AL1(0)             WSKAZNIK ODPOWIEDZI                   ABN00080
         DC    AL1(&BUFNO)        ILOSC BUFOROW                         ABO00090
         AIF   ('&RECFM' NE 'F').E1                                     ABN00100
         DC    X'80'              RECFM=F                               ABN00110
         AGO   .F1                                                      ABN00120
.E1      AIF   ('&RECFM' NE 'V').E2                                     ABN00130
         DC    X'40'              RECFM=V                               ABN00140
         AGO   .F1                                                      ABN00150
.E2      AIF   ('&RECFM' NE 'FA').E3                                    ABN00160
         DC    X'84'              RECFM=FA                              ABN00170
         AGO   .F1                                                      ABN00180
.E3      AIF   ('&RECFM' NE 'VA').E4                                    ABN00190
         DC    X'44'              RECFM=VA                              ABN00200
         AGO   .F1                                                      ABN00210
.E4      AIF   ('&RECFM' NE 'FM').E5                                    ABN00220
         DC    X'82'              RECFM=FM                              ABN00230
         AGO   .F1                                                      ABN00240
.E5      AIF   ('&RECFM' NE 'FB').E6                                    ABN00250
         DC    X'90'              RECFM=FB                              ABN00260
         AGO   .F1                                                      ABN00270
.E6      AIF   ('&RECFM' NE 'VB').E7                                    ABN00280
         DC    X'50'              RECFM=VB                              ABN00290
         AGO   .F1                                                      ABN00300
.E7      AIF   ('&RECFM' NE 'FBA').E8                                   ABN00310
         DC    X'94'              RECFM=FBA                             ABN00320
         AGO   .F1                                                      ABN00330
.E8      AIF   ('&RECFM' NE 'VBA').E9                                   ABN00340
         DC    X'54'              RECFM=VBA                             ABN00350
         AGO   .F1                                                      ABN00360
.E9      AIF   ('&RECFM' NE 'FBM').E10                                  ABN00370
         DC    X'92'              RECFM=FBM                             ABN00380
         AGO   .F1                                                      ABN00390
.E10     AIF   ('&RECFM' NE 'VBS').E11                                  ABN00400
         DC    X'58'              RECFM=VBS                             ABN00410
         AGO   .F1                                                      ABN00420
.E11     AIF   ('&RECFM'(1,1) GT 'Z').E12                               ABO00430
&C.A     DC    &RECFM             FORMAT REKORDOW                       ABO00440
         ORG   &C.A+1                                                   ABO00450
         AGO   .F1                                                      ABO00460
.E12     DC    AL1(&RECFM)        FORMAT REKORDOW                       ABO00470
.F1      DC    AL2(&LRECL)        DLUGOSC REKORDOW                      ABO00480
         DC    AL2(&BLKSIZE)      DLUGOSC BLOKOW                        ABN00490
         MEND                                                           ABN00500
./ ADD NAME=DDENT
         MACRO
&N       DDENT &DD,&T=,&EN=,&OPE=NO
         LCLA  &A,&A1,&A2,&A3
         LCLB  &B1,&B2,&B3,&B4
         LCLC  &C,&C1
*** DDENT      EDYCJA AAS-004
&C       SETC  'IHB'.'&SYSNDX'
         AIF   ('&DD' EQ '').E0
&B1      SETB  ('&DD'(1,1) EQ '''')
         AIF   ('&DD'(1,1) NE '(').E0
&C1      SETC  '0'
.E0      ANOP
&B2      SETB  ('&EN' EQ 'AUTO')
&B3      SETB  ('&T' EQ '')
&B4      SETB  ('&DD' EQ '' OR '&DD' EQ '*')
&A       SETA  &B1*8+&B2*4+&B3*4   OBLICZ DLUGOSC STALYCH
         AIF   (&A EQ 0).E3
&A       SETA  &A+4
&A1      SETA  &B1*8
&A2      SETA  &B2*4+&A1
&A3      SETA  &A2                 WZGLEDNY ADR. ADRESU TIOT
         CNOP  0,4
&N       BAL   14,*+&A
         AIF   (&B1 EQ 0).E1
         DC    CL8&DD
.E1      AIF   (&B2 EQ 0).E2
         DC    A(0)
.E2      AIF   (&B3 EQ 0).E4
         DC    A(0)
         AGO   .E4
.E3      ANOP
         AIF   ('&N' EQ '').E4
&N       DS    0H
.E4      AIF   ('&DD' NE '').E5
         MNOTE *,'PODSTAWIONO JAKO 1 PARAMETR "*"'
         AGO   .G1
.E5      AIF   ('&DD' EQ '*').G1
.*  PRZESZUKIWACZ DO ENTRY
.*  POCZATEK CZESCI WSPOLNEJ
.F1      AIF   ('&T' EQ '').F2
         AIF   ('&T'(1,1) EQ '(').F3
         L     1,&T
         AGO   .F4
.F2      L     1,16 *              CVT ADDRESS
         L     1,0(1) *            POINTER TO CURRENT TCB
         L     1,0(1) *            CURRENT TCB ADDRESS
         L     1,12(1) *           TIOT ADDRESS
         ST    1,&A3.(14) *        STORE TIOT ADDRESS
         AGO   .F4
.F3      LR    1,&T
.F4      LA    1,24(1)
.*  KONIEC CZESCI WSPOLNEJ
         AIF   (&B4 EQ 1).G6
         SR    0,0
         BALR  15,0
         IC    0,0(1)
         LTR   0,0
         BZ    &C.A
         AIF   (&B1 EQ 0).F5
         CLC   4(8,1),0(14)
         AGO   .F6
.F5      CLC   4(8,1),&C1&DD
.F6      BE    &C.A+2
         AR    1,0
         BR    15
&C.A     SR    1,1
.*  POCZATEK CZESCI WSPOLNEJ
.F7      AIF   ('&EN' EQ '').F10
         AIF   ('&EN'(1,1) EQ '(').F8
         AIF   ('&EN' EQ 'AUTO').F9
         ST    1,&EN
         AGO   .F10
.F8      LR    &EN,1
         AGO   .F10
.F9      ST    1,&A1.(14)
.*  KONIEC CZESCI WSPOLNEJ
.F10     AIF   (&B4 EQ 1).G7
         AIF   ('&T' NE '').F11
         L     0,&A3.(14)
.F11     MEXIT
.*  PODAWACZ DO ENTRY
.G1      AIF   ('&EN' EQ '').G2
         AIF   ('&EN'(1,1) EQ '(').G3
         AIF    ('&EN' EQ 'AUTO').G4
         L     1,&EN
.G2      LTR   1,1
         AGO   .G5
.G3      LTR   1,&EN
         AGO   .G5
.G4      L     1,&A1.(14)
         AGO   .G2
.G5      BNZ   &C.A
         AGO   .F1
.G6      AIF   ('&OPE' EQ '').G6A
         AIF   ('&OPE'(1,1) EQ 'N').G6A
         AGO   .G6B
.G6A     B     *+12
.G6B     ANOP
&C.A     SR    0,0
         IC    0,0(1)
         AR    1,0
         AGO   .F7
.G7      CLI   0(1),0
         BNE   *+6
         SR    1,1
         MEND
./ ADD NAME=DRUKUJ
         MACRO
&N       DRUKUJ &D,&R=,&L=,&C=,&SV=,&FD=V,&END=NO
         LCLA  &A1,&A2
         LCLC  &CR,&C1,&C2,&C3,&C4
*** DRUKUJ     EDYCJA AAO-005
         AIF   ('&N' EQ '').E0
&N       DS    0H
.E0      AIF   ('&SV' EQ '').E1
         AIF   ('&SV'(1,1) NE '(').E0A
&C4      SETC  '0'
.E0A     STM   14,1,&C4&SV
.E1      AIF   ('&FD' EQ 'F' OR '&L' EQ '').E9
         AIF   ('&R' NE '').E2
         LR    14,0
&CR      SETC  '(14)'
         AGO   .E3
.E2      AIF   ('&R'(1,1) NE '(').E6
&CR      SETC  '&R'
.E3      AIF   ('&L'(1,1) EQ '(').E5
         AIF   (T'&L EQ 'N' OR T'&L EQ 'U').E4
         MVC   1(1,&CR),&L
         AGO   .E9
.E4      MVI   1&CR,&L
         AGO   .E9
.E5      STC   &L,1&CR
         AGO   .E9
.E6      AIF   ('&L'(1,1) EQ '(').E8
         AIF   (T'&L EQ 'N' OR T'&L EQ 'U').E7
         MVC   &R.+1(1),&L
         AGO   .E9
.E7      MVI   &R.+1,&L
         AGO   .E9
.E8      STC   &L,&R.+1
.E9      AIF   ('&C' EQ '').F8
         AIF   ('&FD' EQ 'F').F0
&A1      SETA  4
.F0      AIF   ('&CR' NE '').F2
         AIF   ('&R' EQ '').F1
&CR      SETC  '&R'
         AGO   .F2
.F1      LR    14,0
&CR      SETC  '(14)'
.F2      AIF   ('&R' EQ '').F5
         AIF   ('&R'(1,1) EQ '(').F5
         AIF   ('&C'(1,1) EQ '(').F4
         AIF   (T'&C EQ 'N' OR T'&C EQ 'U').F3
         MVC   &R.+&A1.(1),&C
         AGO   .F8
.F3      MVI   &R.+&A1,&C
         AGO   .F8
.F4      STC   &C,&R.+&A1
         AGO   .F8
.F5      AIF   ('&C'(1,1) EQ '(').F7
         AIF   (T'&C EQ 'N' OR T'&C EQ 'U').F6
         MVC   &A1.(1,&CR),&C
         AGO   .F8
.F6      MVI   &A1&CR,&C
         AGO   .F8
.F7      STC   &C,&A1&CR
.F8      AIF   ('&R' EQ '').G1
         AIF   ('&R'(1,1) EQ '(').G0
         LA    0,&R
         AGO   .G1
.G0      LR    0,&R
.G1      AIF   ('&D' EQ '').G3
         AIF   ('&D'(1,1) EQ '(').G2
         LA    1,&D
         AGO   .G3X
.G2      LR    1,&D
         AGO   .G3X
.G3      AIF   ('&END'(1,1) EQ 'N').G3X
         MVC   IHB&SYSNDX+1(3),17(1)
.G3X     L     15,20(1)
         BALR  14,15
         AIF   ('&END'(1,1) EQ 'N').G3D
         AIF   ('&D' EQ '').G3B                                       0
         AIF   ('&D'(1,1) EQ '(').G3A
         LA    1,&D+16
         AGO   .G3C
.G3A     LA    1,16&D
         AGO   .G3C
.G3B     CNOP  0,4
         BAL   1,*+8
IHB&SYSNDX DS  F
.G3C     MVI   0(1),128
         SVC   20
.G3D     AIF   ('&SV' EQ '').G4
         LM    14,1,&C4&SV
         BR    14
.G4      MEND
./ ADD NAME=JFCBDEF
         MACRO                                                          AGW00010
         JFCBDEF                                                        AGW00020
JFCBDSNM EQU   0                                                        AGW00030
JFCBELNM EQU   44                                                       AHE00040
JFCBTDSM EQU   52                                                       AGW00050
JFCBLTYP EQU   66                                                       AGW00060
JFCBFLSQ EQU   68                                                       APK00070
JFCBMASK EQU   72                                                       AGW00080
JFCBDEN  EQU   94                                                       AGW00090
JFCBDSOR EQU   98                                                       AGW00100
JFCBRECF EQU   100                                                      AGW00110
JFCBBLKS EQU   102                                                      AGW00120
JFCBLREC EQU   104                                                      AGW00130
JFCBVOLS EQU   118                                                      AGW00140
         MEND                                                           AGW00150
* ACS=                                                                  AGZ00160
*     EXCP                                                              AGZ00170
*    *QSAM                                                              AGZ00180
*     BPAM                                                              AGZ00190
*     BSAM                                                              AGZ00200
* DEV=                                                                  AGZ00210
*    *DA                                                                AGZ00220
*     MT                                                                AGZ00230
*     PR                                                                AGZ00240
*     PT                                                                AGZ00250
*     CR                                                                AGZ00260
*     ALL                                                               AGZ00270
* MCR                                                                   AGZ00280
*    *RD                                                                AGZ00290
*     WT                                                                AGZ00300
         AIF   ('&ACS' NE '').E01                                       AGZ00310
&ACS     SETC  'QSAM'                                                   AGZ00320
.E01     ANOP                                                           AGZ00330
         AIF   ('&DEV' NE '').E02                                       AGZ00340
&DEV     SETC  'DA'                                                     AGZ00350
.E02     ANOP                                                           AGZ00360
         AIF   ('&MCR' NE '').E03                                       AGZ00370
&MCR     SETC  'RD'                                                     AGZ00380
.E03     ANOP                                                           AGZ00390
         AIF   ('&ACS' NE 'ISAM' OR '&ACS' NE 'QISAM').E04              AGZ00400
&DEV     SETC  'DA'                                                     AGZ00410
JFCBDSNM EQU  0                                                         AGY00420
JFCBELNM EQU    44                                                      AGY00430
JFCBTSDM EQU    52                                                      AGY00440
JFCBDSCB EQU    53                                                      AGY00450
JFCBCBID EQU    56                                                      AGY00460
JFCBLTYP EQU    66                                                      AGY00470
JFCBOTTR EQU 67                                                         AGY00480
JFCBUFOF EQU 67                                                         AGY00490
JFCBFLSQ EQU    68                                                      AGY00500
JFCBFUNC EQU    68                                                      AGY00510
JFCBVLSQ EQU    70                                                      AGY00520
JFCBMASK EQU    72                                                      AGY00530
JFCBCRDT EQU    80                                                      AGY00540
JFCBXPDT EQU    83                                                      AGY00550
JFCBIND1 EQU    86                                                      AGY00560
JFCBIND2 EQU    87                                                      AGY00570
JFCBUFNO EQU    88                                                      AGY00580
JFCBUFRQ EQU    88                                                      AGY00590
JFCBUFIN EQU    88                                                      AGY00600
JFCBUFIN JFCBUFOU8                                                      AGY00610
JFCBFTEK EQU   89                                                       AGY00620
JFCBHIAR EQU   89                                                       AGY00630
JFCBFTEK EQU   89                                                       AGY00640
JFCBFALN EQU   89                                                       AGY00650
JFCBFALN JFCBUFL                   EQU                                  AGY00660
JFCEROPT EQU   92                                                       AGY00670
JFCBTRTCH      EQU                           93                         AGY00680
JFCTRTCH EQU   93                                                       AGY00690
JFCKEYLE EQU   93                                                       AGY00700
JFCMODEE EQU   93                                                       AGY00710
JFCMODE  EQU   93                                                       AGY00720
JFCSTACK EQU   93                                                       AGY00730
JFCPRTSP EQU   93                                                       AGY00740
JFCCODE  EQU   93                                                       AGY00750
JFCDEN   EQU   94                                                       AGY00760
JFCLIMCT EQU   96                                                       AGY00770
JFCDSORG EQU   98                                                       AGY00780
JFCRECFM EQU   100                                                      AGY00790
JFCOPTCD EQU   101                                                      AGY00800
JFCBLKSI EQU   102                                                      AGY00810
JFCBUFSI EQU   102                                                      AGY00820
JFCLRECL EQU   104                                                      AGY00830
JFCNCP   EQU   106                                                      AGY00840
JFCNTM   EQU   107                                                      AGY00850
JFCBUFMX EQU   106                                                      AGY00860
JFCPCI   EQU   107                                                      AGY00870
JFCBRSRV EQU   108                                                      AGY00880
JFCINVLT EQU   112                                                      AGY00890
JFCCPRI  EQU   113                                                      AGY00900
JFCTHRSH EQU   113                                                      AGY00910
JFCRKP   EQU   108                                                      AGY00920
JFCCYLOF EQU   110                                                      AGY00930
JFCDBUFN EQU   111                                                      AGY00940
JFCINTVL EQU   112                                                      AGY00950
JFCUCSID EQU   108                                                      AGY00960
JFCUCSOP EQU   112                                                      AGY00970
JFCCPRI  EQU   113                                                      AGY00980
JFCSOWA  EQU   114                                                      AGY00990
JFCOUTLI EQU   113                                                      AGY01000
JFCBNVOL EQU   117                                                      AGY01010
JFCBVOLS EQU   118                                                      AGY01020
JFCBEXTL EQU   148                                                      AGY01030
JFCBEXAD EQU   149                                                      AGY01040
JFCBPQTY EQU   152                                                      AGY01050
JFCBCTRI EQU   155                                                      AGY01060
JFCBSQTY EQU   156                                                      AGY01070
JFCFLGS1 EQU   159                                                      AGY01080
JFCBDQTY EQU   160                                                      AGY01090
JFCBSPNM EQU   163                                                      AGY01100
JFCBABST EQU   166                                                      AGY01110
JFCBSBNM EQU   168                                                      AGY01120
JFCBDRLH EQU   171                                                      AGY01130
JFCBVLCT EQU   174                                                      AGY01140
JFCBSPTN EQU   175                                                      AGY01150
./ ADD NAME=KOMU     0102-86174-86174-0921-00519-00519-00000-ZTSDKJB
         MACRO                                                             00001
         KOMU  &PROG,&KOM=                                                 00002
         LCLA  &A1,&A2                                                     00003
         LCLC  &NK,&PG,&SP                                              ABI00004
         AIF   ('&PROG' NE '').POCZ                                        00005
         MNOTE 8,'   ******** NIEOKRESLONA NAZWA PROGRAMU'                 00006
.POCZ    ANOP                                                              00007
         MNOTE *,'   ******** KOMU       012 '                          ABZ00008
&A1      SETA  1                                                           00009
&A2      SETA  2                                                           00010
&SP      SETC  '       '                                                ABI00011
&PG      SETC  '&PROG&SP'(1,8)                                          ABI00012
         AIF   ('&KOM' NE '').POC                                          00013
         MNOTE *,'    ******** NIEOKRESLONA LISTA KOMUNIKATOW'             00014
         MEXIT                                                             00015
.POC     ANOP                                                              00016
&NK     SETC   '&KOM'(&A2,K'&KOM(&A1))                                     00017
         AIF   ('&NK' NE '000').E000                                       00018
PK&NK    DS    0F                                                          00019
         DC    C'MAN&NK.A '                                                00020
         DC    C'&PG ENTER DISPOSITION'                                    00021
DK&NK    EQU   *-PK&NK                                                     00022
         AGO   .KP                                                         00023
.E000    ANOP                                                              00024
         AIF   ('&NK' NE '001').E001                                       00025
PK&NK    DS    0F                                                          00026
         DC    C'MAN&NK.I '                                                00027
         DC    C'&PG DISPOSITION ERROR'                                    00028
DK&NK    EQU   *-PK&NK                                                     00029
         AGO   .KP                                                         00030
.E001    ANOP                                                              00031
         AIF   ('&NK' NE '002').E002                                       00032
PK&NK    DS    0F                                                          00033
         DC    C'MAN&NK.A '                                                00034
         DC    C'&PG ENTER MODE'                                           00035
DK&NK    EQU   *-PK&NK                                                     00036
         AGO   .KP                                                         00037
.E002    ANOP                                                              00038
         AIF   ('&NK' NE '003').E003                                       00039
PK&NK    DS    0F                                                          00040
         DC    C'MAN&NK.I '                                                00041
         DC    C'&PG INVALID REPLY'                                     ABI00042
DK&NK    EQU   *-PK&NK                                                     00043
         AGO   .KP                                                         00044
.E003    ANOP                                                              00045
         AIF   ('&NK' NE '010').E010                                       00046
PK&NK    DS    0F                                                          00047
         DC    C'MAN&NK.A '                                                00048
         DC    C'&PG ENTER VOLUME-ID'                                      00049
DK&NK    EQU   *-PK&NK                                                     00050
         AGO   .KP                                                         00051
.E010    ANOP                                                              00052
         AIF   ('&NK' NE '011').E011                                       00053
PK&NK    DS    0F                                                          00054
         DC    C'MAN&NK.A '                                                00055
         DC    C'&PG ENTER OLD VOLUME-ID'                                  00056
DK&NK    EQU   *-PK&NK                                                     00057
         AGO   .KP                                                         00058
.E011    ANOP                                                              00059
         AIF   ('&NK' NE '012').E012                                       00060
PK&NK    DS    0F                                                          00061
         DC    C'MAN&NK.A '                                                00062
         DC    C'&PG ENTER NEW VOLUME-ID'                                  00063
DK&NK    EQU   *-PK&NK                                                     00064
         AGO   .KP                                                         00065
.E012    ANOP                                                              00066
         AIF   ('&NK' NE '014').E014                                       00067
PK&NK    DS    0F                                                          00068
         DC    C'MAN&NK.A '                                                00069
         DC    C'&PG ENTER OWNER NAME'                                     00070
DK&NK    EQU   *-PK&NK                                                     00071
         AGO   .KP                                                         00072
.E014    ANOP                                                              00073
         AIF   ('&NK' NE '016').E016                                       00074
PK&NK     DS     0F                                                        00075
         DC     C'MAN&NK.I '                                               00076
         DC    C'&PG VOLUMES ALLOCATED:'                                   00077
DK&NK    EQU   *-PK&NK                                                     00078
         AGO   .KP                                                         00079
.E016    ANOP                                                              00080
         AIF   ('&NK' NE '020').E020                                       00081
PK&NK    DS    0F                                                          00082
         DC    C'MAN&NK.A '                                                00083
         DC    C'&PG ENTER DSN'                                            00084
DK&NK    EQU   *-PK&NK                                                     00085
         AGO   .KP                                                         00086
.E020    ANOP                                                              00087
         AIF   ('&NK' NE '021').E021                                       00088
PK&NK    DS    0F                                                          00089
         DC    C'MAN&NK.A '                                                00090
         DC    C'&PG ENTER DSN-OLD'                                        00091
DK&NK    EQU   *-PK&NK                                                     00092
         AGO   .KP                                                         00093
.E021    ANOP                                                              00094
         AIF   ('&NK' NE '022').E022                                       00095
PK&NK    DS    0F                                                          00096
         DC    C'MAN&NK.A '                                                00097
         DC    C'&PG ENTER DSN-NEW'                                        00098
DK&NK    EQU   *-PK&NK                                                     00099
         AGO   .KP                                                         00100
.E022    ANOP                                                              00101
         AIF   ('&NK' NE '024').E024                                       00102
PK&NK    DS    0F                                                          00103
         DC    C'MAN&NK.I '                                                00104
         DC    C'&PG DDN=XXXXXXXX MISSED'                                  00105
DK&NK    EQU   *-PK&NK                                                     00106
         AGO   .KP                                                         00107
.E024    ANOP                                                              00108
         AIF   ('&NK' NE '025').E025                                       00109
PK&NK    DS    0F                                                          00110
         DC    C'MAN&NK.I '                                                00111
         DC    C'&PG DDN=XXXXXXXX NOT SPECIFIED'                           00112
DK&NK    EQU   *-PK&NK                                                     00113
         AGO   .KP                                                         00114
.E025    ANOP                                                              00115
         AIF   ('&NK' NE '026').E026                                       00116
PK&NK    DS    0F                                                          00117
         DC    C'MAN&NK.A '                                                00118
         DC    C'&PG ENTER MEMBER NAME'                                    00119
DK&NK    EQU   *-PK&NK                                                     00120
         AGO   .KP                                                         00121
.E026    ANOP                                                              00122
         AIF   ('&NK' NE '027').E027                                       00123
PK&NK    DS    0F                                                          00124
         DC    C'MAN&NK.I '                                                00125
         DC    C'&PG DDN'XXXXXXXX DATA SET NOT OPENED'                     00126
DK&NK    EQU   *-PK&NK                                                     00127
         AGO   .KP                                                         00128
.E027    ANOP                                                              00129
         AIF   ('&NK' NE '028').E028                                    ABI00130
PK&NK    DS    0F                                                       ABI00131
         DC    C'MAN&NK.A '                                             ABI00132
         DC    C'&PG ENTER ALIAS NAME'                                  ABI00133
DK&NK    EQU   *-PK&NK                                                  ABI00134
         AGO   .KP                                                      ABI00135
.E028    ANOP                                                           ABI00136
         AIF   ('&NK' NE '030').E030                                       00137
PK&NK    DS    0F                                                          00138
         DC    C'MAN&NK.I '                                                00139
         DC    C'&PG ERROR NO XXX'                                         00140
DK&NK    EQU   *-PK&NK                                                     00141
         AGO   .KP                                                         00142
.E030    ANOP                                                              00143
         AIF   ('&NK' NE '031').E031                                       00144
PK&NK    DS    0F                                                          00145
         DC    C'MAN&NK.I '                                                00146
         DC    C'&PG XXX ERRORS DETECTED'                                  00147
DK&NK    EQU   *-PK&NK                                                     00148
         AGO   .KP                                                         00149
.E031    ANOP                                                              00150
         AIF   ('&NK' NE '032').E032                                    ABA00151
PK&NK    DS    0F                                                       ABA00152
         DC    C'MAN&NK.I '                                             ABA00153
         DC    C'&PG I/O ERROR'                                         ABA00154
DK&NK    EQU   *-PK&NK                                                  ABA00155
         AGO   .KP                                                      ABA00156
.E032    ANOP                                                           ABA00157
         AIF   ('&NK' NE '040').E040                                       00158
PK&NK    DS    0F                                                          00159
         DC    C'MAN&NK.A '                                                00160
         DC    C'&PG SPECIFY PAGE PARAMETERS'                              00161
DK&NK    EQU   *-PK&NK                                                     00162
         AGO   .KP                                                         00163
.E040    ANOP                                                              00164
         AIF   ('&NK' NE '050').E050                                       00165
PK&NK    DS    0F                                                          00166
         DC    C'MAN&NK.A '                                                00167
         DC    C'&PG SPECIFY UNIT NUMBER'                                  00168
DK&NK    EQU   *-PK&NK                                                     00169
         AGO   .KP                                                         00170
.E050    ANOP                                                              00171
         AIF   ('&NK' NE '052').E052                                       00172
PK&NK    DS    0F                                                          00173
         DC    C'MAN&NK.A '                                                00174
         DC    C'&PG SPECIFY UNIT TYPE'                                    00175
DK&NK    EQU   *-PK&NK                                                     00176
         AGO   .KP                                                         00177
.E052    ANOP                                                              00178
         AIF   ('&NK' NE '060').E060                                       00179
PK&NK    DS    0F                                                          00180
         DC    C'MAN&NK.D '                                                00181
         DC    C'&PG SYS1 DATA SET'                                        00182
DK&NK    EQU   *-PK&NK                                                     00183
         AGO   .KP                                                         00184
.E060    ANOP                                                              00185
         AIF   ('&NK' NE '061').E061                                       00186
PK&NK    DS    0F                                                          00187
         DC    C'MAN&NK.D '                                                00188
         DC    C'&PG E-CONFIRM SCRATCH REQUEST'                            00189
DK&NK    EQU   *-PK&NK                                                     00190
         AGO   .KP                                                         00191
.E061    ANOP                                                              00192
         AIF   ('&NK' NE '062').E062                                       00193
PK&NK    DS    0F                                                          00194
         DC    C'MAN&NK.D '                                                00195
         DC    C'&PG E-CONFIRM WRITE REQUEST'                              00196
DK&NK    EQU   *-PK&NK                                                     00197
         AGO   .KP                                                         00198
.E062    ANOP                                                              00199
         AIF   ('&NK' NE '070').E070                                       00200
PK&NK    DS    0F                                                          00201
         DC    C'MAN&NK.A '                                                00202
         DC    C'&PG ENTER FILE NUMBER'                                    00203
DK&NK    EQU   *-PK&NK                                                     00204
         AGO   .KP                                                         00205
.E070    ANOP                                                              00206
         AIF   ('&NK' NE '071').E071                                       00207
PK&NK    DS    0F                                                          00208
         DC    C'MAN&NK.I '                                                00209
         DC    C'&PG XXX FILES READ'                                       00210
DK&NK    EQU   *-PK&NK                                                     00211
         AGO   .KP                                                         00212
.E071    ANOP                                                              00213
         AIF   ('&NK' NE '072').E072                                       00214
PK&NK    DS    0F                                                          00215
         DC    C'MAN&NK.I '                                                00216
         DC    C'&PG XXX FILES WRITTEN'                                    00217
DK&NK    EQU   *-PK&NK                                                     00218
         AGO   .KP                                                         00219
.E072    ANOP                                                              00220
         AIF   ('&NK' NE '073').E073                                       00221
         DC    C'MAN&NK.A '                                             ABI00222
         DC    C'&PG ENTER NUMBER OF COPIES'                               00223
DK&NK    EQU   *-PK&NK                                                     00224
         AGO   .KP                                                         00225
.E073    ANOP                                                              00226
         AIF   ('&NK' NE '074').E074                                       00227
         DC    C'MAN&NK.A '                                             ABI00228
         DC    C'&PG ENTER GENERATION RATIO'                               00229
DK&NK    EQU   *-PK&NK                                                     00230
         AGO   .KP                                                         00231
.E074    ANOP                                                              00232
         AIF   ('&NK' NE '075').E075                                    ABI00233
PK&NK    DS    0F                                                       ABI00234
         DC    C'MAN&NK.A '                                             ABI00235
         DC    C'&PG ENTER RECFM'                                       ABI00236
DK&NK    EQU   *-PK&NK                                                  ABI00237
         AGO   .KP                                                      ABI00238
.E075    ANOP                                                           ABI00239
         AIF   ('&NK' NE '076').E076                                    ABI00240
PK&NK    DS    0F                                                       ABI00241
         DC    C'MAN&NK.A '                                             ABI00242
         DC    C'&PG ENTER LRECL'                                       ABI00243
DK&NK    EQU   *-PK&NK                                                  ABI00244
         AGO   .KP                                                      ABI00245
.E076    ANOP                                                           ABI00246
         AIF   ('&NK' NE '080').E080                                       00247
PK&NK    DS    0F                                                          00248
         DC    C'MAN&NK.I '                                                00249
         DC    C'&PG NO DATA SET ON VOLUME'                                00250
DK&NK    EQU   *-PK&NK                                                     00251
         AGO   .KP                                                         00252
.E080    ANOP                                                              00253
         AIF   ('&NK' NE '081').E081                                       00254
PK&NK    DS    0F                                                          00255
         DC    C'MAN&NK.I '                                                00256
         DC    C'&PG XXX NO CORRECT PASSWORD'                              00257
DK&NK    EQU   *-PK&NK                                                     00258
         AGO   .KP                                                         00259
.E081    ANOP                                                              00260
         AIF   ('&NK' NE '082').E082                                       00261
PK&NK    DS    0F                                                          00262
         DC    C'MAN&NK.I '                                                00263
         DC    C'&PG RETENTION NOT EXPIRED'                                00264
DK&NK    EQU   *-PK&NK                                                     00265
         AGO   .KP                                                         00266
.E082    ANOP                                                              00267
         AIF   ('&NK' NE '083').E083                                       00268
PK&NK    DS    0F                                                          00269
         DC    C'MAN&NK.I '                                                00270
         DC    C'&PG DATA SET EXISTS'                                      00271
DK&NK    EQU   *-PK&NK                                                     00272
         AGO   .KP                                                         00273
.E083    ANOP                                                              00274
         AIF   ('&NK' NE '084').E084                                       00275
PK&NK    DS    0F                                                          00276
         DC    C'MAN&NK.I '                                                00277
         DC    C'&PG PERMANENT I/O ERRORS'                                 00278
DK&NK    EQU   *-PK&NK                                                     00279
         AGO   .KP                                                         00280
.E084    ANOP                                                              00281
         AIF   ('&NK' NE '085').E085                                       00282
PK&NK    DS    0F                                                          00283
         DC    C'MAN&NK.I '                                                00284
         DC    C'&PG NO DEVICE FOR VOLUME'                                 00285
DK&NK    EQU   *-PK&NK                                                     00286
         AGO   .KP                                                         00287
.E085    ANOP                                                              00288
         AIF   ('&NK' NE '086').E086                                       00289
PK&NK    DS    0F                                                          00290
         DC    C'MAN&NK.I '                                                00291
         DC    C'&PG NO VOLUME/SYSCTLG'                                    00292
DK&NK    EQU   *-PK&NK                                                     00293
         AGO   .KP                                                         00294
.E086    ANOP                                                              00295
         AIF   ('&NK' NE '087').E087                                       00296
PK&NK    DS    0F                                                          00297
         DC    C'MAN&NK.I '                                                00298
         DC    C'&PG INCONSISTENT CATALOG STRUCTURE'                       00299
DK&NK    EQU   *-PK&NK                                                     00300
         AGO   .KP                                                         00301
.E087    ANOP                                                              00302
         AIF   ('&NK' NE '088').E088                                       00303
PK&NK    DS    0F                                                          00304
         DC    C'MAN&NK.I '                                                00305
         DC    C'&PG NO INDEX STRUCTURE'                                   00306
DK&NK    EQU   *-PK&NK                                                     00307
         AGO   .KP                                                         00308
.E088    ANOP                                                              00309
         AIF   ('&NK' NE '089').E089                                       00310
PK&NK    DS    0F                                                          00311
         DC    C'MAN&NK.I '                                                00312
         DC    C'&PG NO SPACE AVAILABLE'                                   00313
DK&NK    EQU   *-PK&NK                                                     00314
         AGO   .KP                                                         00315
.E089    ANOP                                                              00316
         AIF   ('&NK' NE '090').E090                                       00317
PK&NK    DS    0F                                                          00318
         DC    C'MAN&NK.I '                                                00319
         DC    C'&PG ERRORS IN XXXXXXXX MACRO'                             00320
DK&NK    EQU   *-PK&NK                                                     00321
         AGO   .KP                                                         00322
.E090    ANOP                                                              00323
         AIF   ('&NK' NE '091').E091                                       00324
PK&NK    DS    0F                                                          00325
         DC    C'MAN&NK.I '                                                00326
         DC    C'&PG ERRORS IN GENERATION NAME'                            00327
DK&NK    EQU   *-PK&NK                                                     00328
         AGO   .KP                                                         00329
.E091    ANOP                                                              00330
         AIF   ('&NK' NE '092').E092                                       00331
PK&NK    DS    0F                                                          00332
         DC    C'MAN&NK.I '                                                00333
         DC    C'&PG PERMANENT CATALOG I/O ERROR'                          00334
DK&NK    EQU   *-PK&NK                                                     00335
         AGO   .KP                                                         00336
.E092    ANOP                                                              00337
         AIF   ('&NK' NE '093').E093                                       00338
PK&NK    DS    0F                                                          00339
         DC    C'MAN&NK.I '                                                00340
         DC    C'&PG INDEX NOT DELETED'                                    00341
DK&NK    EQU   *-PK&NK                                                     00342
         AGO   .KP                                                         00343
.E093    ANOP                                                              00344
         AIF   ('&NK' NE '094').E094                                       00345
PK&NK    DS    0F                                                          00346
         DC    C'MAN&NK.I '                                                00347
         DC    C'&PG NO NAME/NO HIGH LEVEL INDEX'                          00348
DK&NK    EQU   *-PK&NK                                                     00349
         AGO   .KP                                                         00350
.E094    ANOP                                                              00351
         AIF   ('&NK' NE '100').E100                                       00352
PK&NK    DS    0F                                                          00353
         DC    C'MAN&NK.I '                                                00354
         DC    C'&PG NO DOS/OS CONVERTION'                              ABZ00355
DK&NK    EQU   *-PK&NK                                                     00356
         AGO   .KP                                                         00357
.E100    ANOP                                                              00358
         AIF   ('&NK' NE '200').E200                                       00359
PK&NK    DS    0F                                                          00360
         DC    C'MAN&NK.I '                                                00361
         DC    C'&PG PARAMETERS ASSUMED:'                                  00362
DK&NK    EQU   *-PK&NK                                                     00363
         AGO   .KP                                                         00364
.E200    ANOP                                                              00365
         AIF   ('&NK' NE '201').E201                                       00366
PK&NK    DS    0F                                                          00367
         DC    C'MAN&NK.I '                                                00368
         DC    C'&PG DEFAULT PARAMETERS USED'                              00369
DK&NK    EQU   *-PK&NK                                                     00370
         AGO   .KP                                                         00371
.E201    ANOP                                                              00372
         AIF   ('&NK' NE '202').E202                                       00373
PK&NK    DS    0F                                                          00374
         DC    C'MAN&NK.I '                                                00375
         DC    C'&PG WRONG PARAMETER FIELD'                                00376
DK&NK    EQU   *-PK&NK                                                     00377
         AGO   .KP                                                         00378
.E202    ANOP                                                              00379
         AIF   ('&NK' NE '203').E203                                    ABB00380
PK&NK    DS    0F                                                       ABB00381
         DC    C'MAN&NK.I '                                             ABB00382
         DC    C'&PG BEGIN OF PROCESSING'                               ABB00383
DK&NK    EQU   *-PK&NK                                                  ABB00384
         AGO   .KP                                                      ABB00385
.E203    ANOP                                                           ABB00386
         AIF   ('&NK' NE '204').E204                                    ABB00387
PK&NK    DS    0F                                                       ABB00388
         DC    C'MAN&NK.I '                                             ABB00389
         DC    C'&PG UNSUFFICIENT CORE'                                 ABB00390
DK&NK    EQU   *-PK&NK                                                  ABB00391
         AGO   .KP                                                      ABB00392
.E204    ANOP                                                           ABB00393
         AIF   ('&NK' NE '300').E300                                       00394
PK&NK    DS    0F                                                          00395
         DC    C'MAN&NK.I '                                                00396
         DC    C'&PG END OF PROCESSING'                                    00397
DK&NK    EQU   *-PK&NK                                                     00398
         AGO   .KP                                                         00399
.E300    ANOP                                                           AAY00400
         AIF   ('&NK' NE '210').E210                                       00401
PK&NK    DS    0F                                                          00402
         DC    C'MAN&NK.I '                                                00403
DK&NK    EQU   *-PK&NK                                                    00404
         AGO   .KP                                                         00405
.E210    ANOP                                                              00406
         AIF   ('&NK' NE '220').E220                                    ABQ00407
PK&NK    DS    0F                                                       ABQ00408
         DC    C'MAN&NK.D '                                             ABQ00409
         DC    C'&PG CONFIRM'                                           ABQ00410
DK&NK    EQU   *-PK&NK                                                  ABQ00411
         AGO   .KP                                                      ABQ00412
.E220    ANOP                                                           ABQ00413
         AIF   ('&NK' NE '301').E301                                    ABD00414
PK&NK    DS    0F                                                       ABD00415
         DC    C'MAN&NK.I '                                             ABD00416
         DC    C'&PG ACTION REJECTED'                                   ABD00417
DK&NK    EQU   *-PK&NK                                                  ABD00418
         AGO   .KP                                                      ABD00419
.E301    ANOP                                                           ABD00420
         AIF   ('&NK' NE '302').E302                                    ABD00421
PK&NK    DS    0F                                                       ABD00422
         DC    C'MAN&NK.I '                                             ABD00423
         DC    C'&PG ACTION UNSUCCESFULLY TERMINATED'                   ABD00424
DK&NK    EQU   *-PK&NK                                                  ABD00425
         AGO   .KP                                                      ABD00426
.E302    ANOP                                                           ABD00427
         AIF   ('&NK' NE '303').E303                                    ABR00428
PK&NK    DS    0F                                                       ABQ00429
         DC    C'MAN&NK.I '                                             ABQ00430
         DC    C'&PG ACTION CONFIRMED'                                  ABQ00431
DK&NK    EQU   *-PK.&NK                                                 ABQ00432
         AGO   .KP                                                      ABQ00433
.E303    ANOP                                                           ABQ00434
         AIF   ('&NK' NE '400').E400                                    ABB00435
PK&NK    DS    0F                                                       ABB00436
         DC    C'MAN&NK.I '                                             ABB00437
         DC    C'&PG WRONG DSORG DDN=........'                          ABB00438
DK&NK    EQU   *-PK&NK                                                  ABB00439
         AGO   .KP                                                      ABB00440
.E400    ANOP                                                           ABB00441
         AIF   ('&NK' NE '401').E401                                    ABB00442
PK&NK    DS    0F                                                       ABB00443
         DC    C'MAN&NK.I '                                             ABB00444
         DC    C'&PG WRONG RECFM DDN=........'                          ABB00445
DK&NK    EQU   *-PK&NK                                                  ABB00446
         AGO   .KP                                                      ABB00447
.E401    ANOP                                                           ABB00448
         AIF   ('&NK' NE '402').E402                                    ABB00449
PK&NK    DS    0F                                                       ABB00450
         DC    C'MAN&NK.I '                                             ABB00451
         DC    C'&PG WRONG BLKSIZE DDN=........'                        ABB00452
DK&NK    EQU   *-PK&NK                                                  ABB00453
         AGO   .KP                                                      ABB00454
.E402    ANOP                                                           ABB00455
         AIF   ('&NK' NE '403').E403                                    ABB00456
PK&NK    DS    0F                                                       ABB00457
         DC    C'MAN&NK.I '                                             ABB00458
         DC    C'&PG WRONG LRECL DDN=........'                          ABB00459
DK&NK    EQU   *-PK&NK                                                  ABB00460
         AGO   .KP                                                      ABB00461
.E403    ANOP                                                           ABB00462
         AIF   ('&NK' NE '404').E404                                    ABB00463
PK&NK    DS    0F                                                       ABB00464
         DC    C'MAN&NK.I '                                             ABB00465
         DC    C'&PG WRONG LABEL TYPE DDN=........'                     ABB00466
DK&NK    EQU   *-PK&NK                                                  ABB00467
         AGO   .KP                                                      ABB00468
.E404    ANOP                                                           ABB00469
         AIF   ('&NK' NE '800').E800                                    AAY00470
PK&NK    DS    0F                                                       AAY00471
         DC    C'MAN&NK.D '                                             AAY00472
         DC    C'&PG JOB...../STEP.... PGM CHECK TRESHOLD REACHED,REPLYXAAY00473
                GO,ABEND OR DUMP'                                       AAY00474
DK&NK    EQU   *-PK&NK                                                  AAY00475
         AGO   .KP                                                      AAY00476
.E800    ANOP                                                           AAY00477
         AIF   ('&NK' NE '801').E801                                    AAY00478
PK&NK    DS    0F                                                       AAY00479
         DC    C'MAN&NK.I '                                             AAY00480
         DC    C'&PG PGM CHECKS OCCURED'                                AAY00481
DK&NK    EQU   *-PK&NK                                                  AAY00482
         AGO   .KP                                                      AAY00483
.E801    ANOP                                                           AAY00484
         AIF   ('&NK' NE '900').E900                                    AAY00485
PK&NK    DS    0F                                                       AAY00486
         DC    C'MAN&NK.I '                                             AAY00487
         DC    C'&PG END OF PROCESSING FORCED BY EXIT ROUTINE ........' AAY00488
DK&NK    EQU   *-PK&NK                                                  AAY00489
         AGO   .KP                                                      AAY00490
.E900    ANOP                                                           AAY00491
         AIF   ('&NK' NE '901').E901                                    AAY00492
PK&NK    DS    0F                                                          00493
         DC    C'MAN&NK.I '                                                00494
         DC    C'&PG NO INTERFACE WITH EXIT ROUTINE XXXXXXXX'              00495
DK&NK    EQU   *-PK&NK                                                     00496
         AGO   .KP                                                         00497
.E901    ANOP                                                              00498
         AIF   ('&NK' NE '910').E910                                    ABQ00499
PK&NK    DS    0F                                                       ABQ00500
         DC    C'MAN&NK.I '                                             ABQ00501
         DC    C'&PG BEGIN OF EXIT'                                     ABQ00502
DK&NK    EQU   *-PK&NK                                                  ABR00503
         AGO   .KP                                                      ABQ00504
.E910    ANOP                                                           ABQ00505
         AIF   ('&NK' NE '911').E911                                    ABQ00506
PK&NK    DS    0F                                                       ABQ00507
         DC    C'MAN&NK.I '                                             ABQ00508
         DC    C'&PG END OF EXIT'                                       ABQ00509
DK&NK    EQU   *-PK&NK                                                  ABR00510
         AGO   .KP                                                      ABQ00511
.E911    ANOP                                                           ABQ00512
         MNOTE 4,'   ********   BRAK KOMUNIKATU &NK'                       00513
.KP      ANOP                                                              00514
&A2      SETA  &A2+K'&KOM(&A1)+1                                           00515
&A1      SETA  &A1+1                                                       00516
         AIF   (&A2 LT K'&KOM).POC                                         00517
.KON     ANOP                                                              00518
         MEND                                                              00519
./ ADD NAME=PISZ
         MACRO                                                             00010
&N       PISZ  &P,&AD,&AW,&L=1,&FD=F,&SV=                                  00020
         LCLC  &C,&C1,&C2                                                  00030
*** PISZ       WERSJA-003                                               ABJ00040
&C       SETC  '15'                                                        00050
         AIF   ('&N' EQ '').E0                                             00060
&N       DS    0H                                                          00070
.E0      AIF   ('&SV' EQ '').E1                                            00080
         AIF   ('&SV'(1,1) NE '(').E0A                                     00090
&C2      SETC  '0'                                                         00100
.E0A     STM   14,2,&C2&SV *       CHOWAJ REJESTRY                         00110
.E1      AIF   ('&AD' EQ '').E5                                            00120
         AIF   ('&AD'(1,1) EQ '(').E4                                      00130
         AIF   ('&FD' EQ 'F' OR '&FD' EQ 'S').E3                           00140
         AIF   ('&FD' EQ 'H' OR '&FD' EQ 'P').E2                           00150
         AIF   ('&FD' EQ 'A').E1A                                          00160
         SR    0,0                                                         00170
         IC    0,&AD                                                       00180
         AGO   .E5                                                         00190
.E1A     LA    0,&AD                                                       00200
         AGO   .E5                                                         00210
.E2      LH    0,&AD                                                       00220
         AGO   .E5                                                         00230
.E3      L     0,&AD                                                       00240
         AGO   .E5                                                         00250
.E4      LR    0,&AD                                                       00260
.E5      AIF   ('&AW' EQ '').E7                                            00270
         AIF   ('&AW'(1,1) EQ '(').E6                                      00280
         LA    1,&AW                                                       00290
         AGO   .E7                                                         00300
.E6      LR    1,&AW                                                       00310
.E7      AIF   ('&L' EQ '').E9                                             00320
         AIF   ('&L'(1,1) EQ '(').E8                                       00330
         LA    2,&L                                                        00340
         AGO   .E9                                                         00350
.E8      LR    2,&L                                                        00360
.E9      AIF   ('&P' EQ '').F2                                             00370
         AIF   ('&P'(1,1) EQ '(').F1                                       00380
         AIF   (T'&P EQ 'V' OR '&P'(1,1) EQ '=').F0                     ABJ00390
         CNOP  0,4                                                         00400
         B     *+8                                                         00410
         DC    V(&P)                                                       00420
         L     15,*-4                                                      00430
         AGO   .F2                                                         00440
.F0      L     15,&P                                                       00450
         AGO   .F2                                                         00460
.F1      ANOP                                                              00470
&C       SETC  '&P'                                                        00480
.F2      BALR  14,&C                                                       00490
         AIF   ('&SV' EQ '').F3                                            00500
         AIF   ('&SV'(1,1) EQ '(').F2A                                     00510
         ST    15,&SV+4                                                    00520
         AGO   .F2B                                                        00530
.F2A     ST    15,4&SV                                                     00540
.F2B     LM    14,2,&C2&SV *       ODNOW REJESTRY                          00550
         BR    14                                                          00560
.F3      MEND                                                              00570
./ ADD NAME=SEKCJA   0101-99169-99169-1030-00106-00107-00000-VHUTCH
         MACRO                                                             00010
&N       SEKCJA &NS,&B=,&SA=,&V=NO,&ID=NO                               ABJ00020
         LCLA  &A1,&A2,&A3                                                 00030
         LCLC  &C1,&C2                                                     00040
*** SEKCJA     WERSJA-010                                               ABL00050
         AIF   ('&NS' EQ '').E1                                            00060
&NS      CSECT                                                             00070
         AIF   ('&V' EQ 'NO').E1                                           00080
&A1      SETA  K'&NS                                                       00090
&A2      SETA  6                                                           00100
&A3      SETA  0                                                        ABJ00110
&C2      SETC  '0'                                                         00120
&C1      SETC  '&NS'                                                       00130
         AIF   ('&V' EQ 'YES').H0                                          00140
         AIF   (T'&V EQ 'N').H10                                        ABF00150
&A1      SETA  K'&V                                                        00160
&C1      SETC  '&V'                                                        00170
.H0      AIF   (&A2 GT &A1).H2                                             00180
         AIF   ('&C1'(&A2,1) LT '0' OR '&C1'(&A2,1) GT '9').H1             00190
&C2      SETC  '&C2'.'&C1'(&A2,1)                                          00200
.H1      ANOP                                                              00210
&A2      SETA  &A2+1                                                       00220
         AGO   .H0                                                         00230
.H10     ANOP                                                           ABF00240
&C2      SETC  '&V'                                                     ABF00250
         AGO   .H3                                                      ABF00260
.H2      ANOP                                                              00270
         AIF   ('&V' EQ 'YES').H3                                          00280
&V       EQU   &NS                                                         00290
         ENTRY &V                                                          00300
.H3      ANOP                                                              00310
&A1      SETA  &C2                                                         00320
         DC    X'4700'                                                     00330
         DC    AL2(&A1)                                                    00340
&A3      SETA  4                                                        ABJ00350
.E1      ANOP                                                              00360
         AIF   ('&ID' EQ '' OR '&ID' EQ 'NO').G1                        ABJ00370
         AIF   ('&ID' EQ '*' OR '&ID' EQ 'YES').I1                      ABJ00380
&A2      SETA  ((K'&ID-1)/2)*2     ZAOKRAGLIJ DLUGOSC                   ABL00390
&A1      SETA  &A2+4+&A3           PRZESKOK                             ABJ00400
         B     &A1.(15) *     PRZESKOCZ IDENTYFIKATOR                   ABL00410
         DC    CL&A2&ID                                                 ABJ00420
         AGO   .G1                                                      ABJ00430
.I1      ANOP                                                           ABJ00440
&C2      SETC  '&NS'                                                    ABJ00450
         AIF   ('&NS' NE '').I2                                         ABJ00460
&C2      SETC  ' SEKCJA '                                               ABJ00470
.I2      ANOP                                                           ABJ00480
&A2      SETA  &A3+12                                                   ABJ00490
         B     &A2.(15) *          PRZESKOCZ IDENTYFIKATOR              ABJ00500
         DC    CL8'&C2'                                                 ABK00510
.G1      ANOP                                                           ABJ00520
&A2      SETA  0                                                           00530
&N       STM   14,12,12(13)                                                00540
         AIF   ('&B' EQ '').E2                                             00550
         BALR  &B(1),0                                                     00560
         USING *,&B(1)                                                     00570
&A1      SETA  2                                                           00580
.F0      AIF   (&A1 GT N'&B).F1                                            00590
&A2      SETA  &A2+4096                                                    00600
         USING *+&A2,&B(&A1)                                               00610
&A1      SETA  &A1+1                                                       00620
         AGO   .F0                                                         00630
.F1      AIF   (N'&B LE 1).E2                                              00640
&A1      SETA  K'&B(1)                                                     00650
&C1      SETC  '&B'(2,&A1)                                                 00660
&A1      SETA  2                                                           00670
&A2      SETA  2                                                           00680
.E1A     AIF   (N'&B LT &A1).E2                                            00690
&A2      SETA  &A2+K'&B(&A1-1)+1                                           00700
&A3      SETA  K'&B(&A1)                                                   00710
&C2      SETC  '&B'(&A2,&A3)                                               00720
         LA    &C2,2048                                                    00730
         LA    &C2,2048(&C1,&C2)                                           00740
&C1      SETC  '&C2'                                                       00750
&A1      SETA  &A1+1                                                       00760
         AGO   .E1A                                                        00770
.E2      AIF   ('&SA' EQ '').E3                                            00780
&C1      SETC  '72'                                                     ABK00790
         AIF   ('&SA' EQ 'DYNA').D1  STANDARD LV=72                     ABK00800
&C1      SETC  '&SA'                                                    ABK00810
         AIF   (T'&SA EQ 'N').D1     SA=<LICZBA>                        ABK00820
&C1      SETC  '&SA'(2,K'&SA-1)                                         ABK00830
         AIF   ('&SA'(1,1) EQ '*').D1  SA=*<SYMBOL>                     ABK00840
         LR    14,13                                                       00850
         AIF   ('&SA' EQ 'AUTO').EA                                        00860
         LA    13,&SA                                                      00870
         AGO   .EB                                                         00880
.EA      CNOP  0,4                                                         00890
         BAL   13,*+76                                                     00900
         DC    18A(0)                                                      00910
.EB      ST    13,8(14)                                                    00920
         ST    14,4(13)                                                    00930
         L     14,12(14) *    ODNOW REJESTR 14                          ABL00940
         MEXIT                                                          ABK00950
.D1      ANOP                                                           ABK00960
         LA    0,&C1    *     DLUGOSC OBSZARU                           ABL00970
         GETMAIN R,LV=(0) *   POBIERZ PAMIEC                            ABL00980
         LA    0,&C1                                                    ABL00990
         ST    0,0(1) *       PAMIETAJ DLUGOSC                          ABK01000
         LR    14,13                                                    ABK01010
         LR    13,1                                                     ABK01020
         ST    13,8(14) *     DOLACZ DO KOLEJKI                         ABK01030
         ST    14,4(13) *     ADRES POPRZEDNIEGO SA                     ABK01040
         LM    14,1,12(14) *  ODNOW REJESTRY                            ABK01050
.E3      MEND                                                              01060
./ ADD NAME=VCZYT
         MACRO                                                             00010
&N       VCZYT &GEN=0,                                                 XAAZ00020
               &V=VFCLC006                                              AAZ00030
         LCLC  &C                                                          00040
*** VCZYT      WERSJA-006                                               AAZ00050
         AIF   ('&N' NE '').E1                                             00060
         MNOTE 12,'   ********   NIEOKRESLONA NAZWA SEKCJI'                00070
         MEXIT                                                             00080
.E1      ANOP                                                              00090
&C       SETC  'IHB'.'&SYSNDX'                                             00100
         SEKCJA &N,B=12,V=&V                                            AAX00110
         LR    3,1                                                         00120
         XR    0,0                                                         00130
         XR    15,15                                                    AAY00140
         LPR   2,2                                                         00150
         BZ    &C.D                                                     AAY00160
         LR    9,2                                                         00170
         MVI   &C.Z+16,X'CF'                                               00180
         BALR  11,0                                                        00190
         AIF   ('&GEN' EQ '0').E2                                       AAY00200
         CLI   0(3),C' '                                                AAY00210
         BE    &C.C                                                     AAY00220
.E2      CLI   0(3),C'+'                                                AAY00230
         BE    &C.P                                                     AAY00240
         CLI   0(3),C'-'                                                AAX00250
         BE    &C.M                                                     AAY00260
         CLI   0(3),C','                                                AAX00270
         BE    &C.W                                                     AAY00280
         CLI   0(3),C'0'                                                AAX00290
         AIF   ('&GEN' EQ '0').E3                                       AAY00300
         BL    &C.B                                                     AAY00310
         AGO   .E4                                                      AAY00320
.E3      BL    &C.C                                                     AAY00330
.E4      CLI   0(3),C'9'                                                AAY00340
         BNH   &C.E                                                     AAY00350
         AIF   ('&GEN' EQ '0').E5                                       AAY00360
&C.B     LA    15,8                                                     AAY00370
         B     &C.W                                                     AAY00380
.E5      ANOP                                                           AAY00390
&C.C     LA    3,1(3)                                                   AAY00400
         BCTR  2,11                                                        00410
&C.D     LA    15,4                                                     AAY00420
         B     &C.W                                                     AAY00430
&C.E     LR    8,3                                                      AAY00440
         BALR  11,0                                                        00450
         AIF   ('&GEN' EQ '0').E6                                       AAY00460
         CLI   0(3),C' '                                                AAY00470
         BE    &C.S                                                     AAY00480
         CLI   0(3),C','                                                AAY00490
         BE    &C.S                                                     AAY00500
.E6      CLI   0(3),C'0'                                                AAY00510
         AIF   ('&GEN' EQ '0').E7                                       AAY00520
         BL    &C.B                                                     AAY00530
         AGO   .E8                                                      AAY00540
.E7      BL    &C.S                                                     AAY00550
.E8      CLI   0(3),C'9'                                                AAY00560
         AIF   ('&GEN' EQ '0').E9                                       AAY00570
         BH    &C.B                                                     AAY00580
         AGO   .E10                                                     AAY00590
.E9      BH    &C.S                                                     AAY00600
.E10     LA    3,1(3)                                                   AAY00610
         BCTR  2,11                                                        00620
         LR    7,3                                                         00630
         BCT   7,&C.S+2                                                 AAY00640
&C.M     MVI   &C.Z+16,X'DF'                                            AAY00650
         B     &C.C                                                     AAY00660
&C.P     MVI   &C.Z+16,X'CF'                                            AAY00670
         B     &C.C                                                     AAY00680
&C.S     LR    7,3                                                      AAY00690
         SR    3,8                                                         00700
         BCTR  3,0                                                         00710
         STC   3,*+5                                                       00720
         MVC   &C.Z(1),0(8)                                                00730
         LA    2,&C.Z(3)                                                   00740
         NC    0(1,2),&C.Z+16                                              00750
         LA    2,112(3)                                                    00760
         STC   2,*+5                                                       00770
         PACK  &C.Z+8(1),&C.Z(1)                                           00780
         CVB   0,&C.Z+8                                                    00790
         LR    3,7                                                         00800
&C.W     LA    3,1(3)                                                   AAY00810
         SR    3,1                                                         00820
         SLA   3,16                                                        00830
         LR    2,9                                                         00840
         AR    2,3                                                         00850
         LM    3,12,32(13)                                              AAY00860
         BR    14                                                       AAY00870
&C.Z     DS    2D                                                          00880
         DS    X                                                           00890
         MEND                                                              00900
*                                                                       AAX00910
* ZAWARTOSC REJESTROW WEWNATRZ:                                         AAX00920
* R0  PRZECZYTANA LICZBA                                                AAY00930
* R1  ADRES POCZATKU POLA                                               AAY00940
* R2  NIEOKRESLONA                                                      AAY00950
* R3  BIEZACY ADRES ZNAKU                                               AAY00960
* R4-R6 NIE UZYWANE                                                     AAY00970
* R7  ADRES KONCA LICZBY W POLU                                         AAY00980
* R8  ADRES POCZATKU LICZBY W POLU                                      AAY00990
* R9  DLUGOSC POLA                                                      AAY01000
* R10 NIE UZYWANY                                                       AAY01010
* R11 NIEOKRESLONA                                                      AAY01020
* R12 BAZA                                                              AAY01030
* R13 SAVE AREA                                                         AAY01040
* R14 ADRES POWROTU                                                     AAY01050
* R15 KOD POWROTU                                                       AAY01060
*                                                                       AAX01070
./ ADD NAME=VDRUKV   0103-99169-99195-1258-00279-00279-00000-VHUTCH
VDRUKV   CSECT
         ENTRY VFDRA010
VFDRA010 STM   R14,R12,12(R13)             SAVE REGS IN CALLER
         BALR  R12,0                       ADDRESS SET
         USING *,R12
         LR    R14,R13
         BAL   R13,A000058                 PERFORM
         DC    18F'0'
A000058  ST    R13,8(R14)
         ST    R14,4(R13)
         L     R14,12(R14)
         ST    R1,A00039C
         MVC   A0003A5,7(R1)
         LA    R9,A0003A4
         LA    R8,5(R9)
         LR    R3,R0
         TM    10(R1),X'40'
         BO    A0000AC
         MVI   10(R1),X'00'
         L     R5,16(R1)
         TM    48(R5),X'10'
         BO    A0000BE
         MVI   16(R1),X'8F'
         LA    R1,16(R1)
         SVC   19                          OPEN
         L     R1,A00039C
         OI    10(R1),X'80'
         LTR   R15,R15
         BZ    A0000BE
         OI    10(R1),X'40'
A0000AC  LA    R15,4
         L     R13,4(R13)
         L     R14,12(R13)
         LM    R0,R12,20(R13)              RESTORE REGS
         BR    R14                         EXIT
A0000BE  TM    11(R1),X'80'
         BZ    A000280
         CLI   4(R3),C'1'
         BE    A0000F0
         CLI   4(R3),C'C'
         BE    A000278
         BAL   R14,A0002F0                 PERFORM
         BC    4,A0000F0
         L     R13,4(R13)
         LM    R14,R12,12(R13)             RESTORE REGS
         L     R1,16(R1)
         L     R15,48(R1)
         BR    R15
A0000F0  MVC   0(1,R1),1(R1)
         MVI   0(R8),C' '
         MVC   1(250,R8),0(R8)
         TM    11(R1),X'08'
         BZ    A00011C
         SR    R2,R2
         IC    R2,8(R1)
         AR    R2,R8
         MVC   A000117,9(R1)
         DC    C'K'
A000117  DC    X'00'
         DC    H'8192'
         LPR   R1,R8
A00011C  LH    R4,2(R1)
         LA    R5,1(R4)
         STH   R5,2(R1)
         TM    11(R1),X'02'
         BZ    A00014C
         SR    R2,R2
         IC    R2,5(R1)
         AR    R2,R8
         MVC   0(13,R2),A00037C
         TM    11(R1),X'20'
         BZ    A00014C
         MVC   0(4,R2),A000389
A00014C  TM    11(R1),X'04'
         BZ    A0001A0
         LTR   R4,R4
         BZ    A0001A0
         SR    R2,R2
         CVD   R4,A0004A8
         UNPK  A000372,A0004A8(8)
         LA    R4,3
         LA    R5,A000371
         BALR  R7,R0                       ADDRESS SET
         TM    1(R5),X'0F'
         LA    R5,1(R5)
         BC    4,A000182
         MVI   0(R5),C' '
         BCTR  R4,R7
A000182  OI    A000375,X'F0'
         IC    R2,4(R1)
         AR    R2,R8
         MVC   0(11,R2),A00036B
         TM    11(R1),X'20'
         BZ    A0001A0
         MVC   0(6,R2),A000376
A0001A0  TM    11(R1),X'01'
         BZ    A0001EA
         LA    R1,2
         SVC   11                          TIME
         ST    R0,A0004B0
         UNPK  A0004A8(8),A0004B0(4)
         MVC   A00035F,A0004A9
         MVC   A000362,A0004AB
         MVC   A000365,A0004AD
         L     R1,A00039C
         SR    R2,R2
         IC    R2,6(R1)
         AR    R2,R8
         MVC   0(13,R2),A00035A
         TM    11(R1),X'20'
         BZ    A0001EA
         MVC   0(4,R2),A000367
A0001EA  MVI   4(R9),C'1'
         MVC   1(1,R9),7(R1)
         SR    R2,R2
         LR    R0,R9
         L     R1,16(R1)
         L     R15,48(R1)
         BALR  R14,R15                     STD LINKAGE
         L     R1,A00039C
         TM    11(R1),X'10'
         BZ    A000248
         LH    R5,2(R1)
         BCT   R5,A00021A
         B     A000248
A00021A  IC    R2,12(R1)
         LTR   R2,R2
         BNP   A000248
         L     R5,12(R1)
         SR    R4,R4
         BALR  R6,R0                       ADDRESS SET
         L     R1,16(R1)
         LR    R0,R5
         BAL   R14,A0002F0                 PERFORM
         L     R15,48(R1)
         BALR  R14,R15                     STD LINKAGE
         IC    R4,1(R5)
         AR    R5,R4
         L     R1,A00039C
         BCTR  R2,R6
A000248  IC    R0,1(R3)
         STC   R0,A000251
         DC    C'K'
A000251  DC    X'00'
         STM   R0,R10,0(R3)                SAVE REGS
         MVI   14(R9),C'0'
         LA    R0,10(R9)
         BAL   R14,A0002F0                 PERFORM
         L     R13,4(R13)
         ST    R0,20(R13)
         LM    R14,R12,12(R13)             RESTORE REGS
         L     R1,16(R1)
         L     R15,48(R1)
         BR    R15
A000278  MVI   0(R1),X'00'
         B     A000248
A000280  OI    11(R1),X'80'
         LA    R1,2
         SVC   11                          TIME
         ST    R1,A0004A8
         UNPK  A0004B0(5),A0004A9(3)
         MVC   A000387,A0004B0
         ZAP   A0004B0(8),A0004AA
         CVB   R4,A0004B0
         TM    A0004A9,X'01'
         BO    A0002B8
         TM    A0004A9,X'12'
         BM    A0002B8
         OI    A00038E,X'01'
A0002B8  SR    R5,R5
         SR    R7,R7
         BALR  R6,R0                       ADDRESS SET
         IC    R7,A00038D(5)
         LA    R5,1(R5)
         SR    R4,R7
         BCR   2,R6
         AR    R4,R7
         CVD   R4,A0004B0
         UNPK  A000381,A0004B6
         OI    A000382,X'F0'
         CVD   R5,A0004B0
         UNPK  A000384,A0004B6
         OI    A000385,X'F0'
         L     R1,A00039C
         B     A0000F0
A0002F0  STM   R1,R7,24(R13)               SAVE REGS
         L     R1,A00039C
         LR    R3,R0
         CLC   0(2,R3),0(R9)
         BNH   A00030E
         MVC   0(2,R3),0(R9)
         OI    10(R1),X'02'
A00030E  CLC   2(2,R3),2(R9)
         BE    A000322
         MVC   2(2,R3),2(R9)
         OI    10(R1),X'04'
A000322  SR    R4,R4
         SR    R5,R5
         LA    R6,4
         IC    R4,4(R3)
         BALR  R7,R0                       ADDRESS SET
         IC    R5,A00039F(6)
         CR    R4,R5
         BE    A000348
         BCTR  R6,R7
         MVI   4(R3),C' '
         LA    R6,2
         OI    10(R1),X'01'
A000348  BCTR  R6,R0
         IC    R4,0(R1)
         SR    R4,R6
         STC   R4,0(R1)
         LM    R1,R7,24(R13)               RESTORE REGS
         BR    R14                         EXIT
A00035A  EQU   *,13
         DC    C'GODZ '
A00035F  DC    C'  '
         DC    C'.'
A000362  DC    C'  '
         DC    C'.'
A000365  DC    C'  '
A000367  DC    C'TIME'
A00036B  EQU   *,11
         DC    C'STRONA'
A000371  DC    C' '
A000372  EQU   *,4
         DC    C'   '
A000375  EQU   *
         DC    C' '
A000376  DC    C'  PAGE'
A00037C  EQU   *,13
         DC    C'DNIA '
A000381  EQU   *,2
         DC    C' '
A000382  EQU   *
         DC    C' '
         DC    C'.'
A000384  EQU   *,2
         DC    C' '
A000385  EQU   *
         DC    C' '
         DC    C'.'
A000387  DC    C'  '
A000389  DC    C'DATE'
A00038D  DC    X'1F'
A00038E  EQU   *
         DC    H'7199'
         DC    X'1E1F1E1F'
         DC    X'1F1E1F1E'
         DC    X'1F000000'
A00039C  EQU   *
         DC    X'000000'
A00039F  DC    X'00'
         DC    C'+'
         DC    C' '
         DC    C'0'
         DC    C'-'
A0003A4  DC    X'00'
A0003A5  DC    X'00'
         DC    H'0'
         DC    64F'0'
A0004A8  DS    0D
         DC    X'00'
A0004A9  EQU   *,2
         DC    X'00'
A0004AA  EQU   *,2
         DC    X'00'
A0004AB  EQU   *,2
         DC    X'00'
         DC    X'00'
A0004AD  EQU   *,2
         DC    X'00'
         DC    H'0'
A0004B0  DC    F'0'
         DC    H'0'
A0004B6  DC    H'0'
         DC    F'0'
         DROP  R12
         DC    F'0'
./ ADD NAME=VPISZ
         MACRO                                                             00010
&N       VPISZ &ZN=1,&V=VFPLC005                                        ABK00020
         LCLA  &A1                                                         00030
         LCLC  &C1,&C2                                                  ABK00040
*** VPISZ      WERSJA-005                                               ABK00050
&C2      SETC  '&N'                                                     ABK00060
         AIF   ('&N' NE '').E0                                             00070
&C2      SETC  'VPISZ&ZN'                                               ABK00080
         MNOTE 8,' ***** NIEOKRESLONO NAZWY SEKCJI, PRZYJETO &C2'       ABK00090
.E0      ANOP                                                              00100
&A1      SETA  15                                                          00110
&C1      SETC  'IHB'.'&SYSNDX'                                             00120
         SEKCJA &C2,B=12,V=&V                                           ABK00130
         CVD   0,&C1.Z                                                     00140
         UNPK  &C1.Z(16),&C1.Z(8)                                          00150
         LA    3,15                                                        00160
         LA    4,&C1.Z-1                                                   00170
         BALR  5,0                                                         00180
         TM    1(4),15                                                     00190
         BM    *+14                                                        00200
         MVI   1(4),64                                                     00210
         LA    4,1(4)                                                      00220
         BCTR  3,5                                                         00230
         LA    5,16                                                        00240
         SR    2,5                                                         00250
         BNP   *+16                                                        00260
         BALR  6,0                                                         00270
         MVI   0(1),64                                                     00280
         LA    1,1(1)                                                      00290
         BCTR  2,6                                                         00300
         AR    2,5                                                         00310
         AIF   ('&ZN' EQ '0').E2                                           00320
         AIF   ('&ZN' EQ '1').E1                                           00330
         MVI   0(4),C'+'                                                   00340
.E1      TM    &C1.Z+15,16                                                 00350
         BZ    *+8                                                         00360
         MVI   0(4),C'-'                                                   00370
&A1      SETA  &A1+1                                                       00380
.E2      SR    15,15                                                       00390
         LA    7,&C1.Z+&A1                                                 00400
         SR    7,4                                                         00410
         CR    2,7                                                         00420
         BNL   *+14                                                        00430
         ST    7,28(13)                                                    00440
         LA    15,4                                                        00450
         LR    2,7                                                         00460
         LA    4,&C1.Z+15                                                  00470
         OI    0(4),240                                                    00480
         BCTR  2,0                                                         00490
         SR    4,2                                                         00500
         STC   2,*+5                                                       00510
         MVC   0(1,1),0(4)                                                 00520
         LM    0,12,20(13)                                                 00530
         BR    14                                                          00540
&C1.Z    DS    2D                                                          00550
         MEND                                                              00560
./ ADD NAME=VTD
         MACRO                                                             00010
&N       VTD   &PODP,&DCB,&AR=56,&NS=1,&SS=108,&SD=0,&SG=14,           *   00020
               &FD=137,&SW=,&NG=,&T=T,&RECFM=VBA,&BLKSIZE=900,         *   00030
               &WJ=P,                                                  *ABT00040
               &DDNAME=SYSPRINT                                         ABN00050
         LCLA  &A1                                                         00060
         LCLB  &B1,&B2,&B3,&B4,&B5,&B6,&B7                                 00070
         LCLC  &C1,&C2,&C3                                                 00080
*** VTD        WERSJA-007                                               ABT00090
&B1      SETB  ('&SG' NE '')                                               00100
&B2      SETB  ('&SD' NE '')                                               00110
&B3      SETB  ('&SS' NE '')                                               00120
&B4      SETB  ('&SW' NE '')                                               00130
&B5      SETB  ('&NG' NE '')                                               00140
         AIF   ('&WJ'(1,1) EQ 'P').WJ2                                  ABT00150
         AIF   ('&WJ'(1,1) NE 'A').WJ1                                  ABT00160
&B6      SETB  1 .                 USTAW WERSJE ANG.                    ABT00170
         AGO   .WJ2                                                     ABT00180
.WJ1     MNOTE 4,'***** NIEPOPRAWNY ARGUMENT &WJ, PRZYJETO WJ=P'        ABT00190
.WJ2     ANOP                                                           ABT00200
&A1      SETA  &B6*32+&B5*16+&B4*8+&B3*4+&B2*2+&B1                      ABT00210
&C3      SETC  'IHB'.'&SYSNDX'                                             00220
&C1      SETC  '&C3'.'C'                                                   00230
&C2      SETC  'VDRUKV'                                                    00240
         AIF   ('&RECFM'(1,1) EQ 'V').A1                                ABN00250
&C2      SETC  'VDRUKF'                                                 ABN00260
.A1      ANOP                                                           ABN00270
         AIF   ('&DCB' EQ '*' OR '&DCB' EQ '').E0                          00280
&C1      SETC  '&DCB'                                                      00290
.E0      AIF   ('&PODP' EQ '*' OR '&PODP' EQ '').E0A                       00300
&C2      SETC  '&PODP'                                                     00310
.E0A     ANOP                                                              00320
&N       DS    0F                                                          00330
         DC    AL2(&AR)            WYSOKOSC ARKUSZA                        00340
         DC    AL2(&NS)            NUMER STRONY                            00350
         AIF   ('&SS' EQ '').E0B                                           00360
         DC    AL1(&SS)            ODSUNIECIE STRONY                       00370
         AGO   .E0C                                                        00380
.E0B     DC    AL1(0)              BEZ NUMERU STRONY                       00390
.E0C     AIF   ('&SD' EQ '').E0D                                           00400
         DC    AL1(&SD)            ODSUNIECIE DATY                         00410
         AGO   .E0E                                                        00420
.E0D     DC    AL1(0)              BEZ WYPISYWANIA DATY                    00430
.E0E     AIF   ('&SG' EQ '').E0F                                           00440
         DC    AL1(&SG)            ODSUNIECIE GODZINY                      00450
         AGO   .E0G                                                        00460
.E0F     DC    AL1(0)              BEZ WYPISYWANIA GODZINY                 00470
.E0G     ANOP                                                              00480
         DC    AL1(&FD)            DLUGOSC DOKUMENTU                       00490
         AIF   ('&SW' EQ '').E1                                            00500
         DC    AL1(&SW(1))         ODSUNIECIE SYMBOLU WYDAWN.              00510
         DC    AL1(&C3-16-*)       DLUGOSC SYMBOLU WYDAWNICTWA             00520
         DC    AL2(&A1)                                                    00530
         AGO   .E2                                                         00540
.E1      DC    A(&A1)                                                      00550
.E2      AIF   ('&NG' EQ '').E3                                            00560
         DC    AL1(&NG(1))         ILOSC WIERSZY NAGLOWKA                  00570
         DC    AL3(&NG(2))         ADRES NAGLOWKA                          00580
         AGO   .E4                                                         00590
.E3      DC    AL4(0)              NAGLOWEK STRONY                         00600
.E4      DC    A(&C1)              ADRES DCB                               00610
.E4A     DC    V(&C2)                ADRES PODPROGRAMU (MACRO "VDRUK")     00620
.E4B     AIF   ('&SW' EQ '').E5                                            00630
         DC    C&SW(2)             SYMBOL WYDAWNICTWA                      00640
&C3      EQU   *                                                           00650
.E5      AIF   ('&T'(1,1) EQ 'N').E6                                       00660
.E6      AIF   ('&DCB' EQ '*').E7                                          00670
         AIF   ('&DCB' NE '').E8                                           00680
.E7      AIF   ('&RECFM' EQ 'VA' OR '&RECFM' EQ 'VBA').E7A                 00690
         AIF   ('&RECFM' EQ 'FA' OR '&RECFM' EQ 'FBA').E7A                 00700
         MNOTE 12,'**** &RECFM ****   NIEDOZWOLONY FORMAT DOKUMENTU'       00710
         MEXIT                                                             00720
.E7A     ANOP                                                              00730
&C3.C    DCB   DDNAME=&DDNAME,RECFM=&RECFM,DSORG=PS,MACRF=PM,          *   00740
               LRECL=&FD,BLKSIZE=&BLKSIZE                                  00750
.E8      MEND                                                              00760
./ ADD NAME=WROC
         MACRO                                                             00001
&N       WROC  &R,&RC=,&SA=N,&R14=N                                        00002
         LCLA  &A,&R1,&R2                                                  00003
         LCLB  &B,&B13,&B14                                                00004
*** WROC       WERSJA-004                                               ABZ00005
&A       SETA  12                                                          00006
&R1      SETA  14                                                          00007
&R2      SETA  12                                                          00008
&B13     SETB  ('&SA'(1,1) NE 'N')                                         00009
&B14     SETB  ('&SA'(1,1) NE 'N' OR '&R14'(1,1) NE 'N')                   00010
&B14     SETB  (&B14 EQ 1 OR '&R' EQ '')                                ABZ00011
         AIF   ('&N' EQ '').F0                                             00012
&N       DS    0H                                                          00013
.F0      AIF   (&B13 EQ 0).E0                                              00014
         L     13,4(13)                                                    00015
         AIF   ('&SA' NE 'DYNA').E0                                     ABK00016
         AIF   ('&RC' EQ '' AND '&R' EQ '').E2                          ABK00017
         AIF   ('&R' EQ '').E0                                          ABK00018
         AIF   ('&R(1)' EQ '0' OR '&R(1)' GT '13').E0                   ABK00019
         AIF   ('&R(1)' EQ '1').D1                                      ABK00020
         STM   0,1,20(13) *   CHOWAJ REJESTRY 0,1                       ABK00021
         AGO   .E0                                                      ABK00022
.D1      ANOP                                                           ABK00023
         ST    0,20(13) *     CHOWAJ REJESTR 0                          ABK00024
.E0      AIF   ('&RC' EQ '').E2                                            00025
         AIF   ('&RC'(1,1) EQ '(').E1                                      00026
         AIF   (T'&RC EQ 'N' OR T'&RC EQ 'U').E2                           00027
         MVC   16(4,13),&RC                                                00028
         AGO   .E1A                                                        00029
.E1      ST    &RC,16(13)                                                  00030
.E1A     AIF   (&B14 EQ 1).E1B                                             00031
&R1      SETA   15                                                         00032
.E1B     ANOP                                                              00033
&B       SETB  1                                                           00034
.E2      ANOP                                                           ABK00035
         AIF   ('&SA' NE 'DYNA').D2                                     ABK00036
         L     1,8(13) *      ADRES ZWALN. SAVE AREA                    ABK00037
         L     0,0(1) *       DLUGOSC OBSZARU                           ABK00038
         FREEMAIN R,LV=(0),A=(1) * ZWOLNIJ PAMIEC                       ABK00039
.D2      AIF   ('&R' EQ '').E6                                          ABK00040
         AIF   (N'&R EQ 1).E3                                              00041
         AIF   (K'&R(2) EQ 0).E3                                           00042
         AIF    (T'&R(2) EQ 'N').E2C                                       00043
.E2B     MNOTE 8,' &R(2) *****  NIEPOPRAWNY NUMER REJESTRU 2'              00044
         AGO   .E3                                                         00045
.E2C     AIF   (&R(2) GT 12 OR &R(2) LT 0).E2B                             00046
&R2      SETA  &R(2)                                                       00047
.E3      AIF   (K'&R(1) EQ 0).E3C                                       ABZ00048
         AIF   (T'&R(1) EQ 'N').E3B                                        00049
.E3A     MNOTE 8,' &R(1) *****  NIEPOPRAWNY NUMER REJESTRU 1'              00050
         AGO   .E3C                                                        00051
.E3B     AIF (&R(1) GT 15 OR &R(1) LT 0).E3A                               00052
&R1      SETA  &R(1)                                                       00053
.E3C     AIF   (&R1 EQ 14).E6                                              00054
         AIF   (&B14 EQ 0).E4                                              00055
         L     14,12(13)                                                   00056
.E4      AIF   (&R1 EQ 15).E5                                              00057
&A       SETA  &R1*4+20                                                    00058
         AIF   (&B EQ 0).E5                                                00059
         L     15,16(13)                                                   00060
.E5      AIF   (&R1 NE 15).E6                                              00061
&A       SETA  16                                                          00062
.E6      LM    &R1,&R2,&A.(13)                                             00063
         AIF   ('&RC' EQ '' OR &B EQ 1).E8                                 00064
         AIF   ('&RC' NE '0').E7                                           00065
         SR    15,15                                                       00066
         AGO   .E8                                                         00067
.E7      LA    15,&RC                                                      00068
.E8      BR    14                                                          00069
         MEND                                                              00070
